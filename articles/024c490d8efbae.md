---
title: "Stateãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ã£ã¦ã‚¹ãƒˆãƒƒãƒ—ã‚¦ã‚©ãƒƒãƒã‚’å®Ÿè£…ã™ã‚‹ã€ã¤ã„ã§ã«TDDã—ã¦ã¿ã‚‹"
emoji: "ğŸ˜"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["java", "tdd", "ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³"]
published: false
---
# ã¯ã˜ã‚ã«

ã¡ã‚‡ã‚ã£ã¨æ›¸ã„ã¦è‡ªåˆ†ã®ãƒ–ãƒ­ã‚°ã«æŠ•ç¨¿ã—ã‚ˆã†ã¨ã—ã¦ã„ãŸã‚“ã§ã™ãŒã€æƒ³å®šä»¥ä¸Šã®æ–‡é‡ã«ãªã‚Šã›ã£ã‹ããªã®ã§Zennã«æŠ•ç¨¿ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚

ã“ã®è¨˜äº‹ã¯ã€TDDã‚’å®Ÿè·µã—ã¦ã¿ãªãŒã‚‰ã‚¹ãƒˆãƒƒãƒ—ã‚¦ã‚©ãƒƒãƒã‚’å®Ÿè£…ã—ã€ãã®éç¨‹ã§Stateãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ã†å†…å®¹ã¨ãªã£ã¦ã„ã¾ã™ã€‚
ã„ã‹ã‚“ã›ã‚“è¨˜äº‹ãŒé•·ã„ã®ã§Stateãƒ‘ã‚¿ãƒ¼ãƒ³ä½¿ã£ã¦ã„ã‚‹ã¨ã“ã‚ã ã‘è¦‹ãŸã„ã‚“ã˜ã‚ƒï¼ã¨ã„ã†æ–¹ã¯[ä»•æ§˜](#ä»•æ§˜)ã‚’ãƒãƒ©è¦‹ã—ãŸå¾Œã€[çŠ¶æ…‹ã«ã‚ˆã‚‹æŒ¯ã‚‹èˆã„ã®åˆ¶å¾¡ã®ä»•æ–¹ã‚’è€ƒãˆã‚‹](#çŠ¶æ…‹ã«ã‚ˆã‚‹æŒ¯ã‚‹èˆã„ã®åˆ¶å¾¡ã®ä»•æ–¹ã‚’è€ƒãˆã‚‹)ã‚’èª­ã‚“ã§é ‚ã‘ã‚Œã°ã¨æ€ã„ã¾ã™ã€‚

## å‹•æ©Ÿ

- Stateãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç†è§£ã®ãŸã‚ãªã«ã‹å®Ÿè£…ã—ãŸã„
    - Stateãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ã€Œã“ã‚Œã¯Stateãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã‚ã‚‹ã€ã¨å¿µé ­ã«ç½®ããªãŒã‚‰å®Ÿè£…ã—ãŸã“ã¨ãŒãªã„ãŸã‚
- ã¤ã„ã§ã«TDDã‚„ã£ãŸã“ã¨ãªã„ã‹ã‚‰è©¦ã—ã¦ã¿ã‚Œã°ã€ãƒ‡ã‚¶ãƒ‘ã‚¿ã¨TDDå‹‰å¼·ã§ãã¦ãŠå¾—ã˜ã‚ƒã‚“ï¼

# ä»•æ§˜,TODOãƒªã‚¹ãƒˆ

## ä»•æ§˜

ã‚¹ãƒˆãƒƒãƒ—ã‚¦ã‚©ãƒƒãƒã¯ä¸‹è¨˜è¡¨ã®é€šã‚Šã«çŠ¶æ…‹é·ç§»ã™ã‚‹ã¨ã—ã¾ã™ã€‚

> | çŠ¶æ…‹ \\ ã‚¤ãƒ™ãƒ³ãƒˆ | START<br>ãƒœã‚¿ãƒ³æŠ¼ä¸‹ | STOP<br>ãƒœã‚¿ãƒ³æŠ¼ä¸‹ | RESET<br>ãƒœã‚¿ãƒ³æŠ¼ä¸‹ |
> |---------------|:----------------:|:---------------:|:----------------:|
> | åœæ­¢ä¸­        |      è¨ˆæ¸¬ä¸­      |        -        |         -        |
> | è¨ˆæ¸¬ä¸­        |         -        |    çµæœè¡¨ç¤ºä¸­   |         -        |
> | çµæœè¡¨ç¤ºä¸­    |      è¨ˆæ¸¬ä¸­      |        -        |      åœæ­¢ä¸­      |

ã“ã®è¡¨ã¯[ã€ã“ã®1å†Šã§ã‚ˆãã‚ã‹ã‚‹ã€‘ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãƒ†ã‚¹ãƒˆã®æ•™ç§‘æ›¸ï¼»å¢—è£œæ”¹è¨‚ ç¬¬ï¼’ç‰ˆï¼½](https://www.sbcr.jp/product/4815608750/)p.120ã‚ˆã‚Šå¼•ç”¨ã€‚
ï¼ˆã„ã„æ„Ÿã˜ã«çŠ¶æ…‹é·ç§»ã™ã‚‹ã‚‚ã®æ¢ã—ã¦ã‚‹ã¨ãã«ã“ã®è¡¨ã‚’æ€ã„å‡ºã—ãŸã®ã§ã‚¹ãƒˆãƒƒãƒ—ã‚¦ã‚©ãƒƒãƒã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚ã“ã®è¡¨è‡ªä½“ã¯çŠ¶æ…‹é·ç§»ãƒ†ã‚¹ãƒˆã®èª¬æ˜ã§å‡ºã¦ããŸã‚‚ã®ã§ã™ï¼‰

è¡¨ä¸­ã®å€¤ã¯ã€é·ç§»å…ˆã®çŠ¶æ…‹ã‚’ç¤ºã—ã¾ã™ã€‚
ãŸã¨ãˆã°åœæ­¢ä¸­ã§STARTãƒœã‚¿ãƒ³ã‚’æŠ¼ä¸‹ã—ãŸå ´åˆè¨ˆæ¸¬ä¸­ã«é·ç§»ã—ã¾ã™ã€‚
è¡¨ä¸­ã®ã€Œ-ã€ã¯é·ç§»å…ˆã®çŠ¶æ…‹ãŒãªã„ã“ã¨ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚
ãŸã¨ãˆã°åœæ­¢ä¸­ã«STOPãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã‚‚çŠ¶æ…‹é·ç§»ã—ã¾ã›ã‚“ã€‚

ã‚¹ãƒˆãƒƒãƒ—ã‚¦ã‚©ãƒƒãƒã¯ã€çŠ¶æ…‹ã¨è¨ˆæ¸¬å€¤ã‚’ç¢ºèªã§ãã¾ã™ã€‚
åˆæœŸçŠ¶æ…‹ã¯åœæ­¢ä¸­ã€è¨ˆæ¸¬å€¤ã¯0ã§ã™ã€‚

## TODOãƒªã‚¹ãƒˆ

å®Ÿè£…ã™ã‚‹/ãƒ†ã‚¹ãƒˆã™ã‚‹å†…å®¹ã‚’TODOãƒªã‚¹ãƒˆã«ä¸€è¦§åŒ–ã—ã¾ã™ã€‚
ã“ã‚Œã‚’ã‚‚ã¨ã«TDDã‚’é€²ã‚ã¦ã„ãã¾ã™ã€‚

- [ ]  åˆæœŸçŠ¶æ…‹ãŒåœæ­¢ä¸­ã€è¨ˆæ¸¬å€¤ãŒ0
- [ ]  åœæ­¢ä¸­ã§STOPãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„
- [ ]  åœæ­¢ä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒè¨ˆæ¸¬ä¸­ã«é·ç§»ã™ã‚‹
- [ ]  è¨ˆæ¸¬ä¸­ã§STARTãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„
- [ ]  è¨ˆæ¸¬ä¸­ã§STOPãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒçµæœè¡¨ç¤ºä¸­ã«é·ç§»ã™ã‚‹
- [ ]  çµæœè¡¨ç¤ºä¸­ã®è¨ˆæ¸¬å€¤ã¯å¤‰åŒ–ã—ãªã„
- [ ]  çµæœè¡¨ç¤ºä¸­ã§STOPãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„
- [ ]  çµæœè¡¨ç¤ºä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§è¨ˆæ¸¬ä¸­ã«é·ç§»ã™ã‚‹
- [ ]  çµæœè¡¨ç¤ºä¸­ã§RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§åœæ­¢ä¸­ã«é·ç§»ã™ã‚‹

æ„å¤–ã¨å®Ÿè£…ã™ã‚‹ã“ã¨å¤šã„ã§ã™ã­ã€‚ã€‚ã€‚
1ã¤ãšã¤æ¶ˆåŒ–ã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼

# TDDã§å®Ÿè£…ã—ã¦ã„ã

TDDã¯ä¸‹è¨˜ã‚’ç¹°ã‚Šè¿”ã—ã¦å®Ÿè£…ã‚’é€²ã‚ã‚‹ã®ã§ã€ãã‚Œã«åˆã‚ã›ã¦å®Ÿè£…ã‚’é€²ã‚ã¾ã™ã€‚

> ãƒ¬ãƒƒãƒ‰:å‹•ä½œã—ãªã„ã€ãŠãã‚‰ãæœ€åˆã®ã†ã¡ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚‚é€šã‚‰ãªã„ãƒ†ã‚¹ãƒˆã‚’1ã¤æ›¸ãã€‚
> ã‚°ãƒªãƒ¼ãƒ³:ãã®ãƒ†ã‚¹ãƒˆã‚’è¿…é€Ÿã«å‹•ä½œã•ã›ã‚‹ã€‚ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã¯ç½ªã‚’çŠ¯ã—ã¦ã‚‚ã‚ˆã„ã€‚
> ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°:ãƒ†ã‚¹ãƒˆã‚’é€šã™ãŸã‚ã«ç™ºç”Ÿã—ãŸé‡è¤‡ã‚’ã™ã¹ã¦é™¤å»ã™ã‚‹ã€‚

[ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™º](https://shop.ohmsha.co.jp/shopdetail/000000004967/) p.â…¹ã‚ˆã‚Šå¼•ç”¨ã€‚

## åˆæœŸçŠ¶æ…‹ãŒåœæ­¢ä¸­ã€è¨ˆæ¸¬å€¤ãŒ0

### ãƒ¬ãƒƒãƒ‰

ã¾ãšã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‰é€šã‚‰ãªã„ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã¾ã™ã€‚

```java
public class StopwatchTest {
  @Test
  public void testStopState() {
    Stopwatch stopwatch = new Stopwatch();
    assertEquals("IDLE", stopwatch.state);
    assertEquals(0l, stopwatch.time);
  }
}
```

ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã‚’ç›´ã™å®Ÿè£…ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```java
public class Stopwatch {

  public long time;
  public String state;

  public Stopwatch() {
  }

}
```

ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’é€šã™ãŸã‚ã ã‘ã®æœ€å°ã®å®Ÿè£…ãªã®ã§ãƒ„ãƒƒã‚³ãƒŸã©ã“ã‚ã¯ã‚ã‚Šã¾ã™ãŒã€ã‚ˆã—ã¨ã—ã¾ã™ã€‚
TODOãƒªã‚¹ãƒˆã«ä»˜ã‘åŠ ãˆã¦ã€å¾Œå›ã—ã«ã—ã¾ã™ã€‚

- [ ]  åˆæœŸçŠ¶æ…‹ãŒåœæ­¢ä¸­ã€è¨ˆæ¸¬å€¤ãŒ0
- [ ]  åœæ­¢ä¸­ã§STOPãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„
- [ ]  ...(ç•¥)...
- [ ]  time, stateã‚’privateã«ã™ã‚‹(NEW)
- [ ]  stateã¯Stringã§å•é¡Œãªã„ã ã‚ã†ã‹(NEW)

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

![tdd-red](/images/tdd-red.png)

å¤±æ•—ã™ã‚‹ãƒ†ã‚¹ãƒˆã®å®Ÿè¡ŒãŒã§ãã¾ã—ãŸï¼
æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã‚ã‚‹ã‚°ãƒªãƒ¼ãƒ³ã«è¡Œãã¾ã—ã‚‡ã†ã€‚

### ã‚°ãƒªãƒ¼ãƒ³

ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®åˆæœŸåŒ–ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```java
public class Stopwatch {

  public long time;
  public String state = "IDLE"; //ã€€â˜…è¿½åŠ 

  public Stopwatch() {
  }

}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚

![tdd-green](/images/tdd-green.png)

é€šã‚Šã¾ã—ãŸã€‚ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã§ã™ã€‚
ï¼ˆjavaã§longã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ãŒ0ã«ãªã‚‹ã®ã§ã€æ˜ç¤ºçš„ã«0ã‚’ä»£å…¥ã—ãªãã¦ã‚‚ãƒ†ã‚¹ãƒˆãŒé€šã‚Šã¾ã™ï¼‰

â€»ã“ã‚Œä»¥é™ã¯ã‚°ãƒªãƒ¼ãƒ³ã€ãƒ¬ãƒƒãƒ‰ã®ã‚¹ã‚¯ã‚·ãƒ§ã‚’çœç•¥ã—ã¾ã™ã€‚

### ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°

ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã¯ã€æŒ¯ã‚‹èˆã„ã‚’å¤‰ãˆãšã«å†…éƒ¨ã®æ§‹é€ ã‚’æ”¹å–„ã™ã‚‹ä½œæ¥­ã§ã™ãŒã€ä»Šå¿…è¦ã§ã—ã‚‡ã†ã‹ï¼Ÿ
timeã®å€¤ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§0ã«ãªã‚‹ã£ã¦ã„ã†ã“ã¨ã¯ã€è¨€èªä»•æ§˜ã‚’çŸ¥ã£ã¦ã„ãªã„ã¨ã‚ã‹ã‚‰ãªã„ã€ã‚³ãƒ¼ãƒ‰ã®èª­ã¿æ‰‹ã®èƒ½åŠ›ã«ä¾å­˜ã™ã‚‹éƒ¨åˆ†ãªã®ã§æ˜ç¤ºçš„ã«0ã‚’å…¥ã‚Œã¦ãŠããŸã„ã§ã™ï¼ˆç§ã¯ã‚°ãƒªãƒ¼ãƒ³ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦æ€ã„å‡ºã—ã¾ã—ãŸï¼‰ã€‚
ã¾ãŸã€ã“ã‚Œã¯ç§ã®å¥½ã¿ã§ã™ãŒã€å¤‰æ•°ã®åˆæœŸåŒ–ã‚’ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿å†…ã§ã—ãŸããªã£ãŸã®ã§ãã†ã—ã¾ã™ã€‚ãã†ã„ã†ç™–ãªã®ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒä½•æ•…ã‹ãã£ã¡ã®æ–¹ãŒå¿ƒåœ°è‰¯ã„ã§ã™ã€‚ã“ã†ã„ã†ä¿®æ­£ã‚‚ã™ã§ã«ãƒ†ã‚¹ãƒˆãŒæ›¸ã„ã¦ã‚ã‚‹ã®ã§æ°—è»½ã«ã§ãã‚‹ã®ãŒã„ã„ã§ã™ã­ã€‚

```java
public class Stopwatch {

  public long time;
  public String state;

  public Stopwatch() {
    this.time = 0l;
    this.state = "IDLE";
  }

}
```

ãƒ†ã‚¹ãƒˆã‚’é€šã—ã¦ã¿ã¾ã™ã€‚ã€‚ã€‚ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã§ã—ãŸï¼
æŒ¯ã‚‹èˆã„ã‚’å¤‰ãˆãšã«å†…éƒ¨ã®æ§‹é€ ã‚’å¤‰ãˆã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚
TODOãƒªã‚¹ãƒˆã«ãƒã‚§ãƒƒã‚¯ã‚’ã„ã‚Œã¾ã™ã€‚

- [x]  ~~åˆæœŸçŠ¶æ…‹ãŒåœæ­¢ä¸­ã€è¨ˆæ¸¬å€¤ãŒ0~~
- [ ]  åœæ­¢ä¸­ã§STOPãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„
- [ ]  ...(ç•¥)...
- [ ]  time, stateã‚’privateã«ã™ã‚‹
- [ ]  stateã¯Stringã§å•é¡Œãªã„ã ã‚ã†ã‹ï¼Ÿ

æ¬¡ã¯ã€Œtime, stateã‚’privateã«ã™ã‚‹ã€ãŒç°¡å˜ãã†ãªã®ã§æ‰‹ã‚’ã¤ã‘ã¾ã™ã€‚

## time, stateã‚’privateã«ã™ã‚‹

### ãƒ¬ãƒƒãƒ‰

privateã«ã—ã¦getterã‚’è¿½åŠ ã—ãŸã„ã®ã§ã€ã“ã‚Œã«å¯¾å¿œã™ã‚‹ãƒ†ã‚¹ãƒˆã«å¤‰æ›´ã—ã¾ã™ã€‚

```java
public class StopwatchTest {
  @Test
  public void testStopState() {
    Stopwatch stopwatch = new Stopwatch();
    assertEquals("IDLE", stopwatch.getState());
    assertEquals(0l, stopwatch.getTime());
  }
}
```

ä»Šã®ã¾ã¾ã§ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã®ã§ä¿®æ­£ã‚’è¡Œã„ã¾ã™ã€‚

```java
public class Stopwatch {

  // å¤‰æ›´
  private long time;
  private String state;

  public Stopwatch() {
    this.time = 0l;
    this.state = "IDLE";
  }

  // è¿½åŠ 
  public long getTime() {
    return 0l;
  }

  public String getState() {
    return "";
  }
}

```

ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å¯è¦–æ€§ã‚’privateã«å¤‰æ›´ã—ã€getterã‚’è¿½åŠ ã—ã¾ã—ãŸã€‚
ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒé€šã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ãƒ¬ãƒƒãƒ‰ãƒãƒ¼ã§ã—ãŸã€‚
è¿”å´å€¤ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’é€šã™ãŸã‚ã ã‘ã«å…¥ã‚ŒãŸä»®ã®å€¤ãªã®ã§`assertEquals("IDLE", stopwatch.getState());`ã§ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã€‚
æ¬¡ã®ã‚°ãƒªãƒ¼ãƒ³ã§ä¿®æ­£ã—ã¾ã™ã€‚

### ã‚°ãƒªãƒ¼ãƒ³

ãƒ†ã‚¹ãƒˆã‚’é€šã™ãŸã‚ã«ã€ãƒ†ã‚¹ãƒˆãŒé€šã‚‹å€¤ã‚’ãƒ™ã‚¿æ›¸ãã§å®Ÿè£…ã—ã¾ã™ã€‚**ä»®å®Ÿè£…**ã—ã¾ã™ã€‚

```java
public class Stopwatch {

  public long getTime() {
    return 0l;
  }

  public String getState() {
    return "IDLE";
  }
}
```

â€»å¿…è¦ãªç®‡æ‰€ã ã‘å®Ÿè£…ã‚’æŠœãå‡ºã—ã¦ã„ã¾ã™ã€‚ä»¥é™ã€ç‰¹ã«æ–­ã‚‰ãšã«å®Ÿè£…ã‚’å¿…è¦ãªéƒ¨åˆ†ã®ã¿æŠœãå‡ºã™ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã§ã—ãŸã€‚
ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã¯ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã‚’å¾—ã‚‹ã“ã¨ãŒå„ªå…ˆã•ã‚Œã€ç½ªã‚’çŠ¯ã™ã“ã¨ãŒè¨±ã•ã‚Œã‚‹ã®ã§ä»®å®Ÿè£…ã‚‚OKã§ã™ã€‚
ä»®å®Ÿè£…ã¯æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã™ãã«ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã—ã¦ã„ãã®ã§å•é¡Œã‚ã‚Šã¾ã›ã‚“ã€‚ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã¯ã€ãƒ¬ãƒƒãƒ‰ãƒãƒ¼ã§ã‚ã‚‹ã“ã¨ã‚ˆã‚Šæ°—æŒã¡ã‚’è½ã¡ç€ã‹ã›ã¦ãã‚Œã¾ã™ã€‚å®‰å¿ƒã—ã¦ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®ä½œæ¥­ã«å–ã‚Šçµ„ã‚ã¾ã™ã€‚

### ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°

`getTime()`,`getState()`ã§è¿”å´ã™ã‚‹å€¤ã‚’ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å€¤ã«å¤‰ãˆã¾ã™ã€‚

```java
public class Stopwatch {

  private long time;
  private String state;

  public long getTime() {
    return this.time;
  }

  public String getState() {
    return this.state;
  }
}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã§ã—ãŸã€‚
ã“ã‚Œã§å®Œäº†ã§ã™ã€‚TODOãƒªã‚¹ãƒˆã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚

- [x]  ~~åˆæœŸçŠ¶æ…‹ãŒåœæ­¢ä¸­ã€è¨ˆæ¸¬å€¤ãŒ0~~
- [ ]  åœæ­¢ä¸­ã§STOPãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„
- [ ]  ...(ç•¥)...
- [x]  ~~time, stateã‚’privateã«ã™ã‚‹~~
- [ ]  stateã¯Stringã§å•é¡Œãªã„ã ã‚ã†ã‹ï¼Ÿ

stateã®æ‰±ã„ã¯ã¾ã ç½®ã„ã¦æ°—ã«ãªã£ãŸã‚‰å–ã‚Šçµ„ã‚€ã“ã¨ã«ã—ã¾ã™ã€‚
æ¬¡ã¯ã€Œåœæ­¢ä¸­ã§STOPãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„ã€ã«å–ã‚Šçµ„ã¿ã¾ã™ã€‚

## åœæ­¢ä¸­ã§STOPãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„

### ãƒ¬ãƒƒãƒ‰

ã‚¹ãƒˆãƒƒãƒ—ã‚¦ã‚©ãƒƒãƒã®STOPãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã‹ã®ã‚ˆã†ãªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ãŒã„ã„ã®ã§ãã‚Œã£ã½ã„ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã¾ã™ã€‚

```java
  @Test
  public void testStopState() {
    Stopwatch stopwatch = new Stopwatch();
    // -ç•¥-
    stopwatch.stop();
    stopwatch.reset();
    assertEquals("IDLE", stopwatch.getState());
    assertEquals(0l, stopwatch.getTime());
  }
```

ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã®ã§ã“ã‚Œã‚’è§£æ¶ˆã™ã‚‹ãŸã‚ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```java
public class Stopwatch {
  public void stop() {
  }

  public void reset() {
  }

}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ãŠã£ã¨ã€ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ãŒç¾ã‚Œã¾ã—ãŸã€‚
å¶ç„¶ã«ã‚‚ä½•ã‚‚ã—ãªã„ã“ã¨ã‚’æœŸå¾…ã—ã¦ã„ãŸã®ã§ã€ã„ããªã‚Šã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã«ãŸã©ã‚Šç€ãã¾ã—ãŸã€‚

### ã‚°ãƒªãƒ¼ãƒ³

ã™ã§ã«ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã‚’å¾—ã¦ã„ã¾ã™ã®ã§ã€æœ¬ç¯€ã¯ãªã„ã§ã™ã€‚

### ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°

ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ãŒå¿…è¦ã§ã—ã‚‡ã†ã‹ï¼Ÿ
åœæ­¢ä¸­ãªã‚‰ä½•ã‚‚ã—ãªã„ã€ã¨ã„ã†ã“ã¨ãŒä»•äº‹ã§ã‚ã‚‹ã“ã¨ã‚’æ˜ç¤ºã—ãŸã„ã®ã§ã“ã‚ŒãŒã‚ã‹ã‚‹å½¢ã«ã—ãŸã„ã§ã™ã€‚ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ ã—ã¾ã™ã€‚
ä¸€ç¬ä½•ã‚‚ã—ãªã„ãªã‚‰ä¾‹å¤–ã‚’æŠ•ã’ã‚‹ã®ã¯ã©ã†ã ã‚ã†ã‹ï¼Ÿã¨æ€ã„ã¾ã—ãŸãŒã€ã‚¹ãƒˆãƒƒãƒ—ã‚¦ã‚©ãƒƒãƒã®ãƒœã‚¿ãƒ³ã¯ã„ã¤ã§ã‚‚æŠ¼ã›ã‚‹ã®ãŒé€šå¸¸ã§ã€åœæ­¢ä¸­ã§ã‚‚ãƒœã‚¿ãƒ³ãŒæŠ¼ã›ã‚‹ã®ã¯ä¸€èˆ¬çš„ãªã“ã¨ãªã®ã§ä¾‹å¤–ã¯æŠ•ã’ãªã„ã“ã¨ã«ã—ã¾ã™ã€‚ä¾‹å¤–ãŒç™ºç”Ÿã™ã‚‹ã€ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹æ–¹ãŒã³ã£ãã‚Šã—ã¾ã™ã€‚æ‰‹å…ƒã«ã‚ã£ãŸ[Effective Java ç¬¬3ç‰ˆ](https://www.maruzen-publishing.co.jp/item/?book_no=303054)ã‚’ãƒãƒ©ãƒƒã¨ã¿ã¦ã¿ã¦ã‚‚ã€Œä¾‹å¤–çš„çŠ¶æ…‹ã«ã ã‘ä¾‹å¤–ã‚’ä½¿ã†ã€ã¨æ›¸ã„ã¦ã‚ã‚Šã¾ã—ãŸã€‚

```java
  public void stop() {
    // if state is idle, do nothing.
  }

  public void reset() {
    // if state is idle, do nothing.
  }
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚å½“ç„¶ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã®ã¾ã¾ã§ã—ãŸã€‚
ã‚³ãƒ¡ãƒ³ãƒˆã‚’æ›¸ã„ã¦æ€ã„å‡ºã—ã¾ã—ãŸãŒã€ãã†ã„ãˆã°åœæ­¢ä¸­ãªã‚‰ä½•ã‚‚ã—ãªã„ã€ã‚’å®Ÿè£…ã—ã¦ã„ãŸã¯ãšã§ã—ãŸã€‚
åœæ­¢ä¸­ãªã‚‰ã€ã®ifæ–‡ãŒå¿…è¦ãã†ã§ã™ãŒã€ç¾æ®µéšã§ã¯ã¾ã åœæ­¢ä¸­ã®çŠ¶æ…‹ã—ã‹ãªãå½±éŸ¿ãŒãªã„ã®ã§ä¸€æ—¦å…ˆé€ã‚Šã«ã—ã¾ã™ã€‚
TODOãƒªã‚¹ãƒˆã«è¿½åŠ ã—ã¦ã€ç¾åœ¨ã®ã‚¿ã‚¹ã‚¯ã‚’å®Œäº†ã«ã—ã¾ã—ã‚ˆã†ã€‚

- [x]  ~~åˆæœŸçŠ¶æ…‹ãŒåœæ­¢ä¸­ã€è¨ˆæ¸¬å€¤ãŒ0~~
- [x]  ~~åœæ­¢ä¸­ã§STOPãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„~~
- [ ]  åœæ­¢ä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒè¨ˆæ¸¬ä¸­ã«é·ç§»ã™ã‚‹
- [ ]  ...(ç•¥)...
- [ ]  stateã¯Stringã§å•é¡Œãªã„ã ã‚ã†ã‹ï¼Ÿ
- [ ]  çŠ¶æ…‹ã«ã‚ˆã‚‹æŒ¯ã‚‹èˆã„ã®åˆ¶å¾¡ã®ä»•æ–¹ã‚’è€ƒãˆã‚‹ï¼ˆNEW)

æ¬¡ã¯ã€Œåœæ­¢ä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒè¨ˆæ¸¬ä¸­ã«é·ç§»ã™ã‚‹ã€ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚

## åœæ­¢ä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒè¨ˆæ¸¬ä¸­ã«é·ç§»ã™ã‚‹

### ãƒ¬ãƒƒãƒ‰

STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```java
  @Test
  public void testMeasuringState() {
    Stopwatch stopwatch = new Stopwatch();
    stopwatch.start();
    assertEquals("MEASURING", stopwatch.getState());
  }
```

ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒé€šã‚‹ã‚ˆã†ã«å®Ÿè£…ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```java
public class Stopwatch {

  public void start() {
  }

}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ãƒ¬ãƒƒãƒ‰ãƒãƒ¼ã§ã—ãŸã€‚
æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã«ç§»ã‚Šã¾ã—ã‚‡ã†ã€‚

### ã‚°ãƒªãƒ¼ãƒ³

ç¾åœ¨ã®çŠ¶æ…‹ã‚’å¤‰ãˆã‚‹å®Ÿè£…ã‚’åŠ ãˆã¾ã™ã€‚
ã‚„ã‚‹ã¹ãã“ã¨ãŒæ˜ã‚‰ã‹ãªã®ã§ä»Šå›ã¯ä»®å®Ÿè£…ã‚’ã›ãšã«ã€ãã®ã¾ã¾å®Ÿè£…ã—ã¾ã™ã€‚

```java
public class Stopwatch {

  public void start() {
    this.state = "MEASURING";
  }

}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã§ã—ãŸã€‚
ä»Šå›ã®ã‚ˆã†ãªå®Ÿè£…ã¯ã€**æ˜ç™½ãªå®Ÿè£…**ã¨å‘¼ã°ã‚Œã¾ã™ã€‚
ä¸€æ—¦ã“ã“ã§ä»®å®Ÿè£…ã¨æ˜ç™½ãªå®Ÿè£…ã®å®šç¾©ã‚’ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

> - ä»®å®Ÿè£…(p.217):ã‚³ãƒ¼ãƒ‰ã§ã¾ãšãƒ™ã‚¿æ›¸ãã®å€¤ã‚’ä½¿ã„ã€å®Ÿè£…ã‚’é€²ã‚ã‚‹ã«å¾“ã£ã¦ã€å¾ã€…ã«å¤‰æ•°ã«ç½®ãæ›ãˆã¦ã„ãã€‚
> - æ˜ç™½ãªå®Ÿè£…(p.221):ã™ãã«é ­ã®ä¸­ã®å®Ÿè£…ã‚’ã‚³ãƒ¼ãƒ‰ã«è½ã¨ã™ã€‚
 
[ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™º](https://shop.ohmsha.co.jp/shopdetail/000000004967/) p.16ã‚ˆã‚Šå¼•ç”¨ã€‚
(p.217)(p.221)ã¯ãã®ãƒšãƒ¼ã‚¸ã§ä»®å®Ÿè£…ã€æ˜ç™½ãªå®Ÿè£…ã®è©³ã—ã„èª¬æ˜ãŒã•ã‚Œã¦ã„ã¾ã™ã€‚

æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã«ç§»ã‚Šã¾ã™ã€‚

### ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°

ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã¯å¿…è¦ã§ã—ã‚‡ã†ã‹ï¼Ÿ
å‰å›ã®[åœæ­¢ä¸­ã§STOPãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„](#ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°-2)åŒæ§˜ã«ã€åœæ­¢ä¸­ãªã‚‰ã®ifãŒå¿…è¦ãã†ã§ã™ãŒã¾ã ä»–ã®çŠ¶æ…‹ã‚’å®Ÿè£…ã—ã¦ã„ãªã„ã®ã§ç½®ã„ã¦ãŠãã¾ã™ã€‚
ç¾åœ¨ã®ã‚¿ã‚¹ã‚¯ã‚’å®Œäº†ã«ã—ã¾ã™ã€‚

- [x]  ~~åˆæœŸçŠ¶æ…‹ãŒåœæ­¢ä¸­ã€è¨ˆæ¸¬å€¤ãŒ0~~
- [x]  ~~åœæ­¢ä¸­ã§STOPãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„~~
- [x]  ~~åœæ­¢ä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒè¨ˆæ¸¬ä¸­ã«é·ç§»ã™ã‚‹~~
- [ ]  è¨ˆæ¸¬ä¸­ã§STARTãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„
- [ ]  ...(ç•¥)...
- [ ]  stateã¯Stringã§å•é¡Œãªã„ã ã‚ã†ã‹ï¼Ÿ
- [ ]  çŠ¶æ…‹ã«ã‚ˆã‚‹æŒ¯ã‚‹èˆã„ã®åˆ¶å¾¡ã®ä»•æ–¹ã‚’è€ƒãˆã‚‹

æ¬¡ã¯ã€Œè¨ˆæ¸¬ä¸­ã§STARTãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„ã€ã«ç§»ã‚Šã¾ã™ã€‚

## è¨ˆæ¸¬ä¸­ã§STARTãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„

### ãƒ¬ãƒƒãƒ‰

ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```java
  @Test
  public void testMeasuringState() throws Exception {
    Stopwatch stopwatch = new Stopwatch();
    stopwatch.start();
    assertEquals("MEASURING", stopwatch.getState());

    // è¨ˆæ¸¬ä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹
    long firstTime = stopwatch.getTime();
    stopwatch.start();
    // â˜…sleepã‚’æŒŸã‚€ã“ã¨ã§ã€è¨ˆæ¸¬ã—ç¶šã‘ã¦ã„ã‚‹ãªã‚‰çµ¶å¯¾ã«ä»¥å‰å–å¾—ã—ãŸè¨ˆæ¸¬å€¤ã‚ˆã‚Šå¤§ãããªã‚‹ã¯ãšã€‚
    Thread.sleep(10l);
    long secondTime = stopwatch.getTime();
    assertEquals(true, firstTime < secondTime);
    assertEquals("MEASURING", stopwatch.getState());

    // è¨ˆæ¸¬ä¸­ã§RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹
    stopwatch.reset();
    Thread.sleep(10l);
    long thirdTime = stopwatch.getTime();
    assertEquals(true, secondTime < thirdTime);
    assertEquals("MEASURING", stopwatch.getState());
  }
```

ã¡ã‚‡ã£ã¨ã‚³ãƒ¼ãƒ‰é‡ãŒå¤šã„ã®ã§æ•´ç†ã—ã¾ã™ã€‚ä»¥ä¸‹ã‚’ç¢ºèªã™ã‚‹ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã§ã™ã€‚

- è¨ˆæ¸¬ä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§è¨ˆæ¸¬ãŒé€”åˆ‡ã‚Œãšã«ç¶šã„ã¦ã„ã‚‹ã“ã¨
	- çŠ¶æ…‹ãŒè¨ˆæ¸¬ä¸­ã®ã¾ã¾ã§ã‚ã‚‹
	- è¨ˆæ¸¬å€¤ã¯STARTãƒœã‚¿ãƒ³å†æŠ¼ä¸‹å¾Œã®å€¤ãŒã€å†æŠ¼ä¸‹å‰ã®å€¤ã‚ˆã‚Šå¤§ãã„ï¼ˆè¨ˆæ¸¬ãŒç¶šè¡Œã•ã‚Œã¦ã„ã‚‹ï¼‰
- è¨ˆæ¸¬ä¸­ã§SRESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§è¨ˆæ¸¬ãŒé€”åˆ‡ã‚Œãšã«ç¶šã„ã¦ã„ã‚‹ã“ã¨
	- çŠ¶æ…‹ãŒè¨ˆæ¸¬ä¸­ã®ã¾ã¾ã§ã‚ã‚‹
	- è¨ˆæ¸¬å€¤ã¯RESETãƒœã‚¿ãƒ³å†æŠ¼ä¸‹å¾Œã®å€¤ãŒã€å†æŠ¼ä¸‹å‰ã®å€¤ã‚ˆã‚Šå¤§ãã„ï¼ˆè¨ˆæ¸¬ãŒç¶šè¡Œã•ã‚Œã¦ã„ã‚‹ï¼‰

æœªå®Ÿè£…ã®ãƒ¡ã‚½ãƒƒãƒ‰å‘¼ã³å‡ºã—ã¯ãªã„ã®ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã«ã¯ãªã‚Šã¾ã›ã‚“ã€‚
ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¿ã¾ã™ã€‚ã€‚ã€‚ãƒ¬ãƒƒãƒ‰ãƒãƒ¼ã§ã—ãŸã€‚

è¨ˆæ¸¬å€¤ã‚’æ›´æ–°ã›ãšã«0ã‚’è¿”ã—ç¶šã‘ã¦ã„ã‚‹ã®ã§ã€ãã“ã§ã‚¨ãƒ©ãƒ¼ã«ãªã£ã¦ã„ã¾ã™ã€‚

```java
// é–¢ä¿‚ã‚ã‚‹ç®‡æ‰€ã®ç¾åœ¨ã®å®Ÿè£…
public class Stopwatch {
  public Stopwatch() {
    this.time = 0l;
    this.state = "IDLE";
  }

  public long getTime() {
    return this.time;
  }

  public void start() {
    this.state = "MEASURING";
  }

}
```

ã“ã“ã‚’æ¬¡ã®ã‚°ãƒªãƒ¼ãƒ³é€šã™ã‚ˆã†ã«ã—ã¾ã™ã€‚ã§ã™ãŒã€ãã®å‰ã«TDDã®å¨åŠ›ã‚’æ„Ÿã˜ãŸã®ã§ã¡ã‚‡ã£ã¨ã ã‘ã€‚ã€‚

`stopwatch.getTime()`ã§è¨ˆæ¸¬ä¸­ã®å€¤ã‚‚å–å¾—ã™ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ãŒã€
ã‚‚ã—TDDã§ãªã‹ã£ãŸã‚‰ã€å‘¼ã³å‡ºã—å´ç›®ç·šã‹ã‚‰ã®é–‹ç™ºã‚’ã—ã¦ã„ãªã‹ã£ãŸã‚‰ã€æ¬¡ã®å®Ÿè£…ã‚’ã—ã¦ã—ã¾ã„ãã†ã§ã™ã€‚

- `stopwatch.getTime()`ã‚’ä½¿ã†ã®ã§ã¯ãªãã€æ–°ã—ãè¨ˆæ¸¬ä¸­ã®å€¤ã‚’è¿”å´ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã™ã‚‹
- `stopwatch.getTime()`ã¯ç¢ºå®šã—ãŸå€¤ã€åœæ­¢ä¸­ã¾ãŸã¯çµæœè¡¨ç¤ºä¸­ã®å€¤å–å¾—ã§ä½¿ã†

æ—¢ã«ã‚ã‚‹getterã‚’ã„ã˜ã£ãŸã“ã¨ãŒã‚ã‚“ã¾ã‚Šãªã„ã‹ã‚‰ã‹ã€æ–°ãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ ã§ãªã‚“ã¨ãªãã‚„ã£ã¦ã—ã¾ã„ãã†ã§ã™ã€‚ã§ã™ãŒã€ç¾å®Ÿã®ã‚¹ãƒˆãƒƒãƒ—ã‚¦ã‚©ãƒƒãƒã‚’è€ƒãˆã‚‹ã¨ã€çŠ¶æ…‹ã«å¿œã˜ã¦ç¾åœ¨ã®å€¤ã‚’ç¢ºèªã™ã‚‹æ‰‹æ®µãŒã‹ã‚ã‚‹ã§ã—ã‚‡ã†ã‹ã€‚ãã†ã§ã¯ãªãå¸¸ã«ä¸€ã¤ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã€ç”»é¢ã§ç¾åœ¨ã®å€¤ãŒè¡¨ç¤ºã•ã‚Œç¶šã‘ã¦ã„ã‚‹ã‚ˆã†ã«æ€ã„ã¾ã™ã€‚ã“ã‚Œã‚’è€ƒãˆã‚‹ã¨ä¸€ã¤ã®publicãªãƒ¡ã‚½ãƒƒãƒ‰ã‹ã‚‰å¸¸ã«ç¾åœ¨ã®å€¤ã‚’å–å¾—ã§ãã‚‹å®Ÿè£…ã«ãªã£ã¦ã„ã‚‹ã®ãŒè‡ªç„¶ã§ä½¿ã„ã‚„ã™ã„ã‚³ãƒ¼ãƒ‰ã ã¨æ€ã„ã¾ã™ã€‚ã¾ãŸé—‡é›²ã«publicãªãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã™ã‚‹ã®ã‚‚ã‚ã¾ã‚Šè‰¯ããªã„ã§ã—ã‚‡ã†ã€‚

ç‰¹ã«æ„è­˜ã›ãšã«`stopwatch.getTime()`ã§è¨ˆæ¸¬ä¸­ã®å€¤ã‚‚å–å¾—ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚
å‘¼ã³å‡ºã—å´ã‹ã‚‰å®Ÿè£…ã‚’è€ƒãˆã‚‹ã“ã¨ã§ã€ä½¿ã„æ˜“ã„å½¢ã€ç¾å®Ÿã«å³ã—ã¦ã„ã¦ç†è§£ã—ã‚„ã™ã„å½¢ã€ã«ãŸã©ã‚Šã¤ãã“ã¨ãŒã§ãã¾ã—ãŸã€‚

### ã‚°ãƒªãƒ¼ãƒ³

è¤‡é›‘ãªå•é¡Œã«ç›´é¢ã™ã‚‹äºˆæ„ŸãŒã—è‹¥å¹²ä¸å®‰ãªã®ã§ã€ä»Šå›ã¯ä»®å®Ÿè£…ã‹ã‚‰å§‹ã‚ã¾ã™ã€‚
ã¾ãšã¯ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã¨ã„ã†å¿ƒç†çš„ã«å®‰å…¨ãªé ˜åŸŸã‚’æ‰‹ã«å…¥ã‚Œã«ã„ãã¾ã™ã€‚

å•é¡Œã¯timeãŒ0ã‚’è¿”ã—ç¶šã‘ã¦ã„ã‚‹ã“ã¨ã§ç™ºç”Ÿã—ã¦ã„ã‚‹ã®ã§ã€çŠ¶æ…‹ãŒè¨ˆæ¸¬ä¸­ã®å ´åˆã¯getTime()ã§å¸¸ã«ç¾åœ¨ã®ã‚·ã‚¹ãƒ†ãƒ æ™‚é–“ã‚’è¿”ã™ã‚ˆã†ã«ä»®å®Ÿè£…ã—ã¾ã™ã€‚

```java
  public long getTime() {
    if (this.state.equals("MEASURING")) {
      return System.currentTimeMillis();
    } else {
      return this.time;
    }
  }
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã®å–å¾—ã«æˆåŠŸã—ã¾ã—ãŸã€‚å®‰å¿ƒã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ãŸã€‚
ä¸€æ—¦ã“ã“ã¾ã§ã®å®Ÿè£…ã‚’ç½®ã„ã¦ãŠãã¾ã™ã€‚ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã«é€²ã¿ã¾ã™ã€‚

```java
public class Stopwatch {

  private long time;
  private String state;

  public Stopwatch() {
    this.time = 0l;
    this.state = "IDLE";
  }

  public long getTime() {
    if (this.state.equals("MEASURING")) {
      return System.currentTimeMillis();
    } else {
      return this.time;
    }
  }

  public String getState() {
    return this.state;
  }

  public void stop() {
    // if state is idle, do nothing.
  }

  public void reset() {
    // if state is idle, do nothing.
  }

  public void start() {
    this.state = "MEASURING";
  }

}
```

```java
public class StopwatchTest {
  @Test
  public void testStopState() {
    Stopwatch stopwatch = new Stopwatch();
    assertEquals("IDLE", stopwatch.getState());
    assertEquals(0l, stopwatch.getTime());
    stopwatch.stop();
    stopwatch.reset();
    assertEquals("IDLE", stopwatch.getState());
    assertEquals(0l, stopwatch.getTime());
  }

  @Test
  public void testMeasuringState() throws Exception {
    Stopwatch stopwatch = new Stopwatch();
    stopwatch.start();
    assertEquals("MEASURING", stopwatch.getState());

    // è¨ˆæ¸¬ä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹
    long firstTime = stopwatch.getTime();
    stopwatch.start();
    Thread.sleep(10l);
    long secondTime = stopwatch.getTime();
    assertEquals(true, firstTime < secondTime);
    assertEquals("MEASURING", stopwatch.getState());

    // è¨ˆæ¸¬ä¸­ã§RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹
    stopwatch.reset();
    Thread.sleep(10l);
    long thirdTime = stopwatch.getTime();
    assertEquals(true, secondTime < thirdTime);
    assertEquals("MEASURING", stopwatch.getState());
  }
}
```

### ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°

ã•ã¦ã€è¨ˆæ¸¬ä¸­ã®`getTime()`ã§è¿”ã—ã¦æ¬²ã—ã„å€¤ã¯STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã‹ã‚‰ã©ã‚Œã ã‘æ™‚é–“ãŒçµŒã£ãŸã‹ã€ã§ã™ã€‚
ã“ã‚Œã‚’è¨ˆç®—ã™ã‚‹å¼ã¯ã€ç¾åœ¨ã®æ™‚é–“ - STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã®æ™‚é–“ã¨ãªã‚Šã¾ã™ã€‚
ã“ã®ãŸã‚STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã®å€¤ã‚’ä¿æŒã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã§ã€ã¾ãšã“ã®å®Ÿè£…ã‚’åŠ ãˆã¾ã—ã‚‡ã†ã€‚

```java
public class Stopwatch {

  private long time;
  private String state;
  private long startTime; // â˜…è¿½åŠ 

  public void start() {
    this.state = "MEASURING";
    this.startTime = System.currentTimeMillis(); //â˜…è¿½åŠ 
  }

}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã®ã¾ã¾ã§ã™ã€‚
ã§ã¯`getTime()`ã§ã€ç¾åœ¨ã®æ™‚é–“ - STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã®æ™‚é–“ã€ã®å€¤ã‚’è¿”ã™ã‚ˆã†ã«ã—ã¾ã™ã€‚

```java
public class Stopwatch {
  public long getTime() {
    if (this.state.equals("MEASURING")) {
      return System.currentTimeMillis() - this.startTime;
    } else {
      return this.time;
    }
  }
}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã§ã™ï¼
åœæ­¢ä¸­ã®çŠ¶æ…‹ã®è¿”å´å€¤ã§ã™ãŒã€

```java
else {
      return this.time;
    }
```

å¸¸ã«0ã‚’è¿”å´ã™ã‚‹ã“ã¨ã«æ°—ã¥ã„ãŸã®ã§ã€ãã®ã‚ˆã†ã«ä¿®æ­£ã—ã¾ã™ã€‚

```java
  public long getTime() {
    if (this.state.equals("MEASURING")) {
      return System.currentTimeMillis() - this.startTime;
    } else {
      return 0l;
    }
  }
```

ãƒ†ã‚¹ãƒˆã‚’é€šã—ã¾ã™ã€‚ã€‚ã€‚ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã§ã™ã€‚
ã“ã®ä¿®æ­£ã«ã‚ˆã‚Šãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®timeãŒä¸è¦ã«ãªã£ãŸã®ã§æ¶ˆã—ã¾ã™ã€‚ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ãƒ©ã®åˆæœŸåŒ–ã‚‚æ¶ˆã—ã¾ã™ã€‚
ã¤ã„ã§ã«startTimeã§ã™ãŒã€0ã§åˆæœŸã—ã¦ãŠãã¾ã™ã€‚æ˜ç¤ºçš„ã«0ã‚’å…¥ã‚Œã¦ãŠããŸã„æ°—æŒã¡ã§ã™ã€‚

```java
public class Stopwatch {

  private String state;
  private long startTime;

  public Stopwatch() {
    this.state = "IDLE";
    this.startTime = 0l;
  }

}
```

ãƒ†ã‚¹ãƒˆã‚’é€šã—ã¾ã™ã€‚ã€‚ã€‚ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã§ã—ãŸã€‚
TODOãƒªã‚¹ãƒˆã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¾ã™ã€‚

- [x]  ~~åˆæœŸçŠ¶æ…‹ãŒåœæ­¢ä¸­ã€è¨ˆæ¸¬å€¤ãŒ0~~
- [x]  ~~åœæ­¢ä¸­ã§STOPãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„~~
- [x]  ~~åœæ­¢ä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒè¨ˆæ¸¬ä¸­ã«é·ç§»ã™ã‚‹~~
- [x]  ~~è¨ˆæ¸¬ä¸­ã§STARTãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„~~
- [ ]  è¨ˆæ¸¬ä¸­ã§STOPãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒçµæœè¡¨ç¤ºä¸­ã«é·ç§»ã™ã‚‹
- [ ]  ...(ç•¥)...
- [ ]  stateã¯Stringã§å•é¡Œãªã„ã ã‚ã†ã‹ï¼Ÿ
- [ ]  çŠ¶æ…‹ã«ã‚ˆã‚‹æŒ¯ã‚‹èˆã„ã®åˆ¶å¾¡ã®ä»•æ–¹ã‚’è€ƒãˆã‚‹

æ¬¡ã¯ã€Œè¨ˆæ¸¬ä¸­ã§STOPãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒçµæœè¡¨ç¤ºä¸­ã«é·ç§»ã™ã‚‹ã€ã«å–ã‚Šçµ„ã¿ã¾ã™ã€‚

## è¨ˆæ¸¬ä¸­ã§STOPãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒçµæœè¡¨ç¤ºä¸­ã«é·ç§»ã™ã‚‹

### ãƒ¬ãƒƒãƒ‰

ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```java
@Test
  public void testMeasuringState() throws Exception {
    // -ç•¥-
    // è¨ˆæ¸¬ä¸­ã§STOPãƒœã‚¿ãƒ³æŠ¼ä¸‹
    long stoppedTime = stopwatch.getTime();
    stopwatch.stop();
    Thread.sleep(10l);
    assertEquals("RESULT", stopwatch.getState());
    assertEquals(stoppedTime, stopwatch.getTime());
  }
```

STOPãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã«æœŸå¾…ã™ã‚‹å‹•ä½œã¯ä¸‹è¨˜ã§ã™ã€‚

- çŠ¶æ…‹ãŒçµæœè¡¨ç¤ºä¸­ã«é·ç§»ã™ã‚‹ã€‚
- `stop()`æ™‚ã«è¨ˆæ¸¬å€¤ã‚’ä¿å­˜ã™ã‚‹ã€‚
- `stop()`å‘¼ã³å‡ºã—ä»¥é™ã€è¨ˆæ¸¬å€¤ãŒæ›´æ–°ã•ã‚Œãªã„ã€‚

å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ãƒ¬ãƒƒãƒ‰ãƒãƒ¼ã§ã™ã€‚

### ã‚°ãƒªãƒ¼ãƒ³

ä»Šå›ã¯ä»®å®Ÿè£…ã‚’ã¯ã•ã¾ãªã„ã§å®Ÿè£…ã—ã¾ã™ã€‚
ç‰¹ã«ä¸å®‰ãŒãªã„ã®ã§ä¸€æ°—ã«æ˜ç™½ãªå®Ÿè£…ã«ã‚¸ãƒ£ãƒ³ãƒ—ã—ã¾ã™ã€‚

```java
public class Stopwatch {

  private String state;
  private long startTime;
  private long time; // å¾©æ´»

  public Stopwatch() {
    this.state = "IDLE";
    this.startTime = 0l;
    this.time = 0l; // å¾©æ´»
  }

  // -ç•¥-
  public void stop() {
    if (state.equals("MEASURING")) {
      this.state = "RESULT";
      this.time = System.currentTimeMillis() - this.startTime;
    } else if (state.equals("IDLE")) {
      // if state is idle, do nothing.
    }
  }

```

ä¸‹è¨˜ã®å®Ÿè£…ã‚’åŠ ãˆã¾ã—ãŸã€‚

- åœæ­¢ãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã«è¨ˆæ¸¬å€¤ã‚’ä¿å­˜ã™ã‚‹å¿…è¦ãŒã‚ã£ãŸã®ã§ã€å‰ç¯€ã§æ¶ˆã—ãŸtimeã‚’å¾©æ´»
- `stop()`ã«è¨ˆæ¸¬ä¸­ãªã‚‰çŠ¶æ…‹ã‚’çµæœè¡¨ç¤ºä¸­ã«å¤‰æ›´ã™ã‚‹ã€è¨ˆæ¸¬å€¤ã‚’ä¿å­˜ã™ã‚‹å®Ÿè£…ã‚’è¿½åŠ 

ãƒ†ã‚¹ãƒˆã‚’å‹•ã‹ã—ã¦ã¿ã¾ã™ã€‚ã€‚ã€‚

ãƒ¬ãƒƒãƒ‰ãƒãƒ¼ã§ã—ãŸã€‚ã€‚ã€‚ã‚ã‚Œã£ï¼Ÿ
ä¸€æ°—ã«ã‚¸ãƒ£ãƒ³ãƒ—ã—ã™ããŸã‚ˆã†ã§ã™ã€‚ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’ç¢ºèªã—ã¾ã™ã€‚

```
org.opentest4j.AssertionFailedError: expected: <21> but was: <0>
  at org.junit.jupiter.api.AssertionUtils.fail(AssertionUtils.java:55)
```

`expected: <21> but was: <0>`ã“ã“ãŒæ›²è€…ã®ã‚ˆã†ã§ã™ã€‚
ã©ã†ã‚„ã‚‰21ã‚’æœŸå¾…ã—ã¦ã„ã‚‹ã®ã«0ã ã£ãŸã¨ã€‚ã€‚

ãªã‚‹ã»ã©ã€ãã†ã„ãˆã°`getTime()`ã§ã€çµæœè¡¨ç¤ºä¸­ã®çŠ¶æ…‹ã®è¨ˆæ¸¬å€¤ã‚’å–å¾—ã™ã‚‹å®Ÿè£…ãŒãªã„ã“ã¨ã«æ°—ã¥ãã¾ã—ãŸã€‚ã“ã‚ŒãŒãªã‘ã‚Œã°è¨ˆæ¸¬ä¸­ -> çµæœè¡¨ç¤ºä¸­ã®é·ç§»æ™‚ã«æ­£ã—ãè¨ˆæ¸¬å€¤ã‚’ä¿å­˜ã§ãã¦ã„ã‚‹ã‹ç¢ºèªã§ãã¾ã›ã‚“ã€‚å®Ÿè£…ã‚’åŠ ãˆã¾ã™ã€‚

```java
public long getTime() {
    if (this.state.equals("MEASURING")) {
      return System.currentTimeMillis() - this.startTime;
    } else if (this.state.equals("RESULT")) {
      // â˜…è¿½åŠ 
      return this.time;
    } else {
      return 0l;
    }
  }
```

ãƒ†ã‚¹ãƒˆãŒæˆåŠŸã™ã‚‹ã®ã‚’ç¥ˆã‚Šã¤ã¤å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã§ã—ãŸã€‚
ä¸€æ—¦ã“ã“ã§åŒºåˆ‡ã‚Šã¾ã™ã€‚
ã„ã‚ã‚“ãªã¨ã“ã‚ã§stateã«ã‚ˆã‚‹åˆ¶å¾¡ãŒå‡ºã¦ããŸã®ã§ã€ã€ŒçŠ¶æ…‹ã«ã‚ˆã‚‹æŒ¯ã‚‹èˆã„ã®åˆ¶å¾¡ã®ä»•æ–¹ã‚’è€ƒãˆã‚‹ã€ã«ç§»ã‚Šã¾ã™ã€‚ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã¯ãã®ç¯€ã§è¡Œã„ã¾ã™ã€‚

ä¸€æ—¦TODOãƒªã‚¹ãƒˆã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¾ã™ã€‚

- [x]  ~~åˆæœŸçŠ¶æ…‹ãŒåœæ­¢ä¸­ã€è¨ˆæ¸¬å€¤ãŒ0~~
- [x]  ~~åœæ­¢ä¸­ã§STOPãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„~~
- [x]  ~~åœæ­¢ä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒè¨ˆæ¸¬ä¸­ã«é·ç§»ã™ã‚‹~~
- [x]  ~~è¨ˆæ¸¬ä¸­ã§STARTãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„~~
- [x]  ~~è¨ˆæ¸¬ä¸­ã§STOPãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒçµæœè¡¨ç¤ºä¸­ã«é·ç§»ã™ã‚‹~~
- [ ]  ...(ç•¥)...
- [ ]  stateã¯Stringã§å•é¡Œãªã„ã ã‚ã†ã‹ï¼Ÿ
- [ ]  çŠ¶æ…‹ã«ã‚ˆã‚‹æŒ¯ã‚‹èˆã„ã®åˆ¶å¾¡ã®ä»•æ–¹ã‚’è€ƒãˆã‚‹,stop,reset,startã«åˆ¶å¾¡è¿½åŠ 

## çŠ¶æ…‹ã«ã‚ˆã‚‹æŒ¯ã‚‹èˆã„ã®åˆ¶å¾¡ã®ä»•æ–¹ã‚’è€ƒãˆã‚‹

Stateãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ã†ã®ãŒè¨˜äº‹ã®è¶£æ—¨ã®ä¸€ã¤ãªã®ã§ã“ã“ã§ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’é©ç”¨ã—ãŸã„ã®ã§ã™ãŒã€ã¾ãšã¯ä»Šã®å®Ÿè£…ã®å•é¡Œç‚¹ã‚’æ˜ã‚‰ã‹ã«ã—ãŸã„ã§ã™ã€‚stateã«ã‚ˆã‚‹çŠ¶æ…‹åˆ†å²ãŒã‚ã‚‹å®Ÿè£…ã‚’ç¢ºèªã—ã¾ã™ã€‚

```java
public class Stopwatch {
  public long getTime() {
    if (this.state.equals("MEASURING")) {
      return System.currentTimeMillis() - this.startTime;
    } else if (this.state.equals("RESULT")) {
      return this.time;
    } else {
      return 0l;
    }
  }

  public void stop() {
    if (state.equals("MEASURING")) {
      this.state = "RESULT";
      this.time = System.currentTimeMillis() - this.startTime;
    } else if (state.equals("IDLE")) {
      // if state is idle, do nothing.
    }
  }

  public void start() {
    if (this.state.equals("IDLE")) {
      this.state = "MEASURING";
      this.startTime = System.currentTimeMillis();
    }
  }
}
```

çœºã‚ã¦ã¿ã‚‹ã¨ä¸‹è¨˜ã®å•é¡ŒãŒè¦‹ãˆã¦ãã¾ã™ã€‚

- çŠ¶æ…‹ã«ã‚ˆã‚‹åˆ†å²ãŒæ•£ã‚‰ã°ã£ã¦ã„ã‚‹ãŸã‚ã€å¤‰æ›´ã‚’å…¥ã‚Œã‚‹å ´åˆã‚ã¡ã“ã¡ã«æ‰‹ã‚’å…¥ã‚Œã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚é‡è¦ãªå¤‰æ›´ã‚’å®Ÿè£…ã—å¿˜ã‚Œã‚‹å¯èƒ½æ€§ãŒå‡ºã¦ãã‚‹ã€‚å®Ÿéš›ã€[å…ˆã»ã©](#ã‚°ãƒªãƒ¼ãƒ³-5)å®Ÿè£…ã—å¿˜ã‚Œã«ã‚ˆã‚Šæƒ³å®šå¤–ã®ãƒ¬ãƒƒãƒ‰ãƒãƒ¼ãŒå‡ºãŸã€‚
- ãã®çŠ¶æ…‹ã«ä¾ã‚‹å®Ÿè£…ãŒã©ã“ã«ã‚ã‚‹ã‹ã¡ã‚‡ã£ã¨ã‚ã‹ã‚Šã¥ã‚‰ã„ã€‚ifã®æ¡ä»¶ã‚’ç¢ºèªã—ãªã„ã¨ã©ã“ã«ä¿®æ­£ã‚’ã„ã‚Œã‚‹ã¹ãã‹ã‚ã‹ã‚‰ãªã„ã€‚

ã•ã¦ã€ã©ã‚“ãªé“å…·ã‚’ä½¿ãˆã°å•é¡ŒãŒè§£æ±ºã§ãã‚‹ã§ã—ã‚‡ã†ã‹ï¼Ÿ
Stateãƒ‘ã‚¿ãƒ¼ãƒ³ã®èª¬æ˜ã‚’ã¿ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

> **â—‰ç›®çš„**
ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å†…éƒ¨çŠ¶æ…‹ãŒå¤‰åŒ–ã—ãŸã¨ãã«ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒæŒ¯ã‚‹èˆã„ã‚’å¤‰ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ã‚¯ãƒ©ã‚¹å†…ã§ã¯ã€æŒ¯ã‚‹èˆã„ã®å¤‰åŒ–ã‚’è¨˜è¿°ã›ãšã€çŠ¶æ…‹ã‚’è¡¨ã™ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å°å…¥ã™ã‚‹ã“ã¨ã§ã“ã‚Œã‚’å®Ÿç¾ã™ã‚‹ã€‚


> **â—‰é©ç”¨å¯èƒ½æ€§**
æ¬¡ã«ç¤ºã™ã„ãšã‚Œã‹ã®å ´åˆã«ã€Stateãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åˆ©ç”¨ã™ã‚‹ã€‚
ï¼ˆä¸­ç•¥ï¼‰
â—ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®çŠ¶æ…‹ã«ä¾å­˜ã—ãŸå¤šå²ã«ã‚ãŸã‚‹æ¡ä»¶æ–‡ã‚’æŒã£ã¦ã„ã‚‹å ´åˆã€‚
ï¼ˆä¸­ç•¥ï¼‰Stateãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã¯ã€1ã¤1ã¤ã®æ¡ä»¶åˆ†å²ã‚’åˆ¥ã€…ã®ã‚¯ãƒ©ã‚¹ã«å—ã‘æŒãŸã›ã‚‹ã€‚(å¾Œç•¥)
> 

> **â—‰çµæœ**
Stateãƒ‘ã‚¿ãƒ¼ãƒ³ã¯æ¬¡ã®ã‚ˆã†ãªçµæœã‚’ã‚‚ãŸã‚‰ã™ã€‚
> 1. **çŠ¶æ…‹ã«ä¾å­˜ã—ãŸæŒ¯ã‚‹èˆã„ã‚’å±€æ‰€åŒ–ã—ã€çŠ¶æ…‹ã”ã¨ã«æŒ¯ã‚‹èˆã„ã‚’åˆ†å‰²ã™ã‚‹**ã€‚(å¾Œç•¥)


[ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã«ãŠã‘ã‚‹å†åˆ©ç”¨ã®ãŸã‚ã®ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³(æ”¹è¨‚ç‰ˆï¼‰](https://www.sbcr.jp/product/4797311126/)pp.325-327ã‚ˆã‚Š

- ã‚¯ãƒ©ã‚¹å†…ã§ã¯æŒ¯ã‚‹èˆã„ã®å¤‰åŒ–ã‚’è¨˜è¿°ã›ãšã€çŠ¶æ…‹ã‚’è¡¨ã™ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å°å…¥ã™ã‚‹ã“ã¨ã§ã“ã‚Œã‚’å®Ÿç¾ã™ã‚‹
- Stateãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã¯ã€1ã¤1ã¤ã®æ¡ä»¶åˆ†å²ã‚’åˆ¥ã€…ã®ã‚¯ãƒ©ã‚¹ã«å—ã‘æŒãŸã›ã‚‹
- çŠ¶æ…‹ã«ä¾å­˜ã—ãŸæŒ¯ã‚‹èˆã„ã‚’å±€æ‰€åŒ–ã—ã€çŠ¶æ…‹ã”ã¨ã«æŒ¯ã‚‹èˆã„ã‚’åˆ†å‰²ã™ã‚‹

-> çŠ¶æ…‹ã«ã‚ˆã‚‹æ¡ä»¶åˆ†å²ã‚’1ã¤1ã¤ã®ã‚¯ãƒ©ã‚¹ã«æŠ¼ã—è¾¼ã‚ãã†ã€ã‚«ãƒ—ã‚»ãƒ«åŒ–ã§ããã†ã§ã™ã€‚

ãªã‚“ã ã‹ç¾åœ¨ç›´é¢ã—ã¦ã„ã‚‹å•é¡Œã«å¯¾ã—ã¦æœ‰åŠ¹ãã†ãªã®ã§ã€Stateãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ã£ã¦ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã—ã¾ã™ã€‚ã—ã‹ã—å¤§æ‰‹è¡“ã«ãªã‚‹ã®ã§ã€Stateãƒ‘ã‚¿ãƒ¼ãƒ³ã¸ã®å®Ÿè£…ã‚’å…¥ã‚Œæ›¿ãˆã¯ã™ã¹ã¦ã€å…·è±¡ã‚¯ãƒ©ã‚¹ã‚’ç›´æ¥å‘¼ã³å‡ºã™å½¢ã§å®Ÿè£… -> ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹å‘¼ã³å‡ºã—ã«å®Ÿè£…ã‚’å¤‰æ›´ã€ã¨ã„ã†æµã‚Œã§ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã‚’è¡Œã„ã¾ã™ã€‚æŒ¯ã‚‹èˆã„ã¯å¤‰ãˆãšã«å†…éƒ¨æ§‹é€ ã‚’å¤‰ãˆã‚‹è¡Œç‚ºãªã®ã§ã€ãƒ†ã‚¹ãƒˆã¯æ—¢ã«æ›¸ã„ã¦ã‚ã‚‹ã‚‚ã®ã‚’åˆ©ç”¨ã—ã¦ã„ãã¾ã™ã€‚

### ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°

### æ‰‹è¡“ç¬¬1å¼¾: Stateå…·è±¡ã‚¯ãƒ©ã‚¹ã‚’å‘¼ã³å‡ºã™ã‚ˆã†ã«å®Ÿè£…ã‚’å¤‰ãˆã‚‹

ã¾ãšã€å…¨ã¦ã®çŠ¶æ…‹ã‚¯ãƒ©ã‚¹ãŒå®Ÿè£…ã™ã‚‹Stateã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‚’ä½œã‚Šã¾ã™ã€‚
ä¸€æ—¦ã€æ¡ä»¶åˆ†å²ãŒã™ããªã„startãƒ¡ã‚½ãƒƒãƒ‰ã‚’Stateã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã«ç§»ã™ã“ã¨ã‹ã‚‰å§‹ã‚ã¾ã™ã€‚

```java
interface State {
  public void start(Stopwatch stopwatch);
}
// ------------------------------------------
public class Stopwatch {
  public void start() {
    if (this.state.equals("IDLE")) {
      this.state = "MEASURING";
      this.startTime = System.currentTimeMillis();
    }
  }
}
```

ãã‚Œãã‚Œã®çŠ¶æ…‹åˆ†ã€Stateã®å…·è±¡ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```java
public class InitState implements State {
  @Override
  public void start(Stopwatch stopwatch) {
    // TODO è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸãƒ¡ã‚½ãƒƒãƒ‰ãƒ»ã‚¹ã‚¿ãƒ–
  }
}
// ------------------------------------------
public class MeasuringState implements State {
  @Override
  public void start(Stopwatch stopwatch) {
    // TODO è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸãƒ¡ã‚½ãƒƒãƒ‰ãƒ»ã‚¹ã‚¿ãƒ–
  }
}
// ------------------------------------------
public class ResultState implements State {
  @Override
  public void start(Stopwatch stopwatch) {
    // TODO è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸãƒ¡ã‚½ãƒƒãƒ‰ãƒ»ã‚¹ã‚¿ãƒ–
  }
}
```

- åœæ­¢ä¸­ã€åˆæœŸçŠ¶æ…‹ã®ã‚¯ãƒ©ã‚¹ã‚’InitStateã¨å‘½åã—ã¾ã—ãŸã€‚
    - ä»Šã¾ã§"IDLE"ã¨ã—ã¦ã„ãŸã‘ã©ã€ãªã‚“ã‹ã—ã£ãã‚Šã“ãªã‹ã£ãŸã®ã§ã€‚çµæœè¡¨ç¤ºä¸­ -> RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§åˆæœŸçŠ¶æ…‹ã«ã‚‚ã©ã‚‹ã£ã¦ã„ã†é¢¨ã«è€ƒãˆãŸã‚‰ã€InitãŒã„ã„æ„Ÿã˜ã‹ãªã¨æ€ã„ã¾ã—ãŸã€‚
- è¨ˆæ¸¬ä¸­ã®ã‚¯ãƒ©ã‚¹ã‚’MeasuringState, çµæœè¡¨ç¤ºä¸­ã®ã‚¯ãƒ©ã‚¹ã‚’ResultStateã¨ã—ã¾ã—ãŸã€‚

`stopwatch.start()`ã®å‡¦ç†ã‚’InitStateã«ç§»ã—ã¾ã™ã€‚

```java
public class Stopwatch {

  public void start() {
    new InitState().start(this);
  }
}
// ------------------------------------------
public class InitState implements State {
  @Override
  public void start(Stopwatch stopwatch) {
    this.state = "MEASURING";
    this.startTime = System.currentTimeMillis();
  }
}
// ------------------------------------------
public class MeasuringState implements State {
  @Override
  public void start(Stopwatch stopwatch) {
    // do nothing.
  }
}
```

stopwatchã®å¤‰æ•°ã‚’InitStateã‹ã‚‰å¼„ã‚Œã‚‹ã‚ˆã†ã«setterã‚’è¿½åŠ ã—ã¾ã™ã€‚

```java
public class Stopwatch {

  private String state;
  private long startTime;

  void setState(String state) {
    this.state = state;
  }

  void setStartTime(long startTime) {
    this.startTime = startTime;
  }
// ------------------------------------------
public class InitState implements State {

  @Override
  public void start(Stopwatch stopwatch) {
    stopwatch.setState("MEASURING");
    stopwatch.setStartTime(System.currentTimeMillis());
  }

}
```

ã“ã“ã§ä¸€æ—¦ãƒ†ã‚¹ãƒˆã‚’å‹•ã‹ã—ã¾ã™ã€‚ã€‚ã€‚ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã§ã—ãŸã€‚

æ¬¡ã¯`stopwatch.stop()`ã®æ‰‹è¡“ã«æ‰‹ã‚’ã¤ã‘ã¾ã™ã€‚
Stateã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã«`stop()`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã—ã€`stopwatch.stop()`ã®å‡¦ç†ã‚’ç§»ã—ã¾ã™ã€‚

```java
interface State {
  public void stop(Stopwatch stopwatch);
}
// ------------------------------------------
public class InitState implements State {
  @Override
  public void stop(Stopwatch stopwatch) {
    // do nothing.
  }
// ------------------------------------------
public class MeasuringState implements State {
  @Override
  public void stop(Stopwatch stopwatch) {
    this.state = "RESULT";
    this.time = System.currentTimeMillis() - this.startTime;
  }
// ------------------------------------------
public class ResultState implements State {
  @Override
  public void stop(Stopwatch stopwatch) {
    // TODO è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸãƒ¡ã‚½ãƒƒãƒ‰ãƒ»ã‚¹ã‚¿ãƒ–
  }
}
```

Stopwatchã«startTimeã®getter, timeã®setterã‚’è¿½åŠ ã—ã¾ã™ã€‚
MeasuringStateã®`stop()`ã§stopwatchã®timeã®è¨ˆç®—/è¨­å®šã‚’ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã§ã™ã€‚

```java
public class Stopwatch {

  private long startTime;
  private long time;

  long getStartTime() {
    return this.startTime;
  }

  void setTime(long time) {
    this.time = time;
  }

  void setState(String state) {
    this.state = state;
  }
}
// ------------------------------------------
public class MeasuringState implements State {

  @Override
  public void stop(Stopwatch stopwatch) {
    stopwatch.setState("RESULT");
    stopwatch.setTime(System.currentTimeMillis() - stopwatch.getStartTime());
  }
}

```

Stopwatchã®`stop()`ã‹ã‚‰Stateå…·è±¡ã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™ã‚ˆã†ã«ã—ã¾ã™ã€‚

```java
public class Stopwatch {

  public void stop() {
    if (state.equals("MEASURING")) {
      new MeasuringState().stop(this);
    } else if (state.equals("IDLE")) {
      new InitState().stop(this);
    }
  }

}
```

æ‰‹è¡“å®Œäº†ã§ã™ã€‚ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã§ã—ãŸã€‚
æ¬¡ã«`stopwatch.getTime()`ã‚’è€ƒãˆã¾ã™ã€‚ã‚„ã‚‹ã“ã¨ã¯å¤§ä½“åŒã˜ãªã®ã§ä¸€æ°—ã«å®Ÿè£…ã—ã¾ã™ã€‚

```java
public class Stopwatch {

  private long startTime;
  private long time;

  long getStartTime() {
    return this.startTime;
  }

  // ResultStateã‹ã‚‰timeã‚’ä½¿ã†éƒ½åˆã§getterè¿½åŠ ã€‚
  long getTimeInner() {
    return this.time;
  }

  public long getTime() {
    if (this.state.equals("MEASURING")) {
      return new MeasuringState().getTime(this);
    } else if (this.state.equals("RESULT")) {
      return new ResultState().getTime(this);
    } else {
      return new InitState().getTime(this);
    }
  }
}
// ------------------------------------------
interface State {
  public long getTime(Stopwatch stopwatch);
}
// ------------------------------------------
public class InitState implements State {
  @Override
  public long getTime(Stopwatch stopwatch) {
    return 0l;
  }
}
// ------------------------------------------
public class MeasuringState implements State {
  @Override
  public long getTime(Stopwatch stopwatch) {
    return System.currentTimeMillis() - stopwatch.getStartTime();
  }
}
// ------------------------------------------
public class ResultState implements State {
  @Override
  public long getTime(Stopwatch stopwatch) {
    return stopwatch.getTimeInner();
  }
}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã§ã—ãŸã€‚
`stopwatch.getState()`ã‚’è€ƒãˆã¾ã™ã€‚
ã“ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯ç¾åœ¨ã®çŠ¶æ…‹ã‚’ç¤ºã™å€¤ã‚’è¿”ã—ã¾ã™ã€‚ã“ã‚Œã‚‚çŠ¶æ…‹ã«ä¾ã‚‹å®Ÿè£…ãªã®ã§Stateã‚¯ãƒ©ã‚¹ã«å‡¦ç†ã‚’å§”è­²ã—ã¾ã—ã‚‡ã†ã€‚

```java
public class Stopwatch {
  public String getState() {
    if (this.state.equals("MEASURING")) {
      return new MeasuringState().getState();
    } else if (this.state.equals("RESULT")) {
      return new ResultState().getState();
    } else {
      return new InitState().getState();
    }
  }
}
// ------------------------------------------
interface State {
  public String getState();
}
// ------------------------------------------
public class InitState implements State {
  @Override
  public String getState() {
    return "IDLE";
  }
}
// ------------------------------------------
public class MeasuringState implements State {
  @Override
  public String getState() {
    return "MEASURING";
  }
}
// ------------------------------------------
public class ResultState implements State {
  @Override
  public String getState() {
    return "RESUlT";
  }
}
```

ãƒ†ã‚¹ãƒˆã‚’å‹•ã‹ã—ã¾ã™ã€‚ã€‚ã€‚ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã§ã—ãŸã€‚
æ‰‹è¡“ç¬¬ä¸€å¼¾ãŒçµ‚ã‚ã‚Šã¾ã—ãŸã€‚

### æ‰‹è¡“ç¬¬2å¼¾: Stateã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‚’å‘¼ã³å‡ºã™å®Ÿè£…ã«å¤‰ãˆã‚‹

Stateã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ç®‡æ‰€ã‚’æŠœãå‡ºã—ã¦ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦ã¿ã¾ã™ã€‚

```java
public class Stopwatch {

  private String state;
  private long startTime;
  private long time;

  void setState(String state) {
    this.state = state;
  }

  public long getTime() {
    if (this.state.equals("MEASURING")) {
      return new MeasuringState().getTime(this);
    } else if (this.state.equals("RESULT")) {
      return new ResultState().getTime(this);
    } else {
      return new InitState().getTime(this);
    }
  }

  public String getState() {
    if (this.state.equals("MEASURING")) {
      return new MeasuringState().getState();
    } else if (this.state.equals("RESULT")) {
      return new ResultState().getState();
    } else {
      return new InitState().getState();
    }
  }

  public void stop() {
    if (state.equals("MEASURING")) {
      new MeasuringState().stop(this);
    } else if (state.equals("IDLE")) {
      new InitState().stop(this);
    }
  }

  public void start() {
    new InitState().start(this);
  }
}
```

Stopwatchå†…ã®ifã‚’æ¶ˆã—ãŸã„ã§ã™ã€‚ãƒãƒªãƒ¢ãƒ•ã‚£ã‚ºãƒ ã‚’ä½¿ã„ã¾ã™ã€‚
Stateå…·è±¡ã‚¯ãƒ©ã‚¹ã‚’ä½¿ã£ã¦ã„ã‚‹ç®‡æ‰€ã‚’ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã®å‘¼ã³å‡ºã—ã«å¤‰ãˆã¾ã™ã€‚
ã‚¯ãƒ©ã‚¹å†…ã§Stateã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‚’æŒã¡ã€çŠ¶æ…‹é·ç§»æ™‚ã«å…·è±¡ã‚¯ãƒ©ã‚¹ã‚’å…¥ã‚Œæ›¿ãˆã¦ã„ãã¾ã™ã€‚
`private String state;`ã‚’`private State state;`ã«å¤‰æ›´ã—ã€`setState()`å‘¼ã³å‡ºã—æ™‚ã«æ¬¡ã«é·ç§»ã™ã‚‹Stateå…·è±¡ã‚¯ãƒ©ã‚¹ã‚’è¨­å®šã—ã¾ã™ã€‚

```java
public class Stopwatch {

  private State state;
  private long startTime;
  private long time;

  public Stopwatch() {
    this.state = new InitState();
    this.startTime = 0l;
    this.time = 0l;
  }

  public long getTime() {
    return this.state.getTime(this); // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã®å‘¼ã³å‡ºã—
  }

  public String getState() {
    return this.state.getState(); // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã®å‘¼ã³å‡ºã—
  }

  void setState(State state) {
    this.state = state;
  }

  public void stop() {
    this.state.stop(this); // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã®å‘¼ã³å‡ºã—
  }

  public void start() {
    this.state.start(this); // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã®å‘¼ã³å‡ºã—
  }
}
// ------------------------------------------
public class InitState implements State {

  private final MeasuringState measuringState = new MeasuringState();

  @Override
  public void start(Stopwatch stopwatch) {
    stopwatch.setState(this.measuringState); // æ¬¡ã«é·ç§»ã™ã‚‹çŠ¶æ…‹ã‚’è¨­å®š
    stopwatch.setStartTime(System.currentTimeMillis());
  }
}
// ------------------------------------------
public class MeasuringState implements State {

  private final ResultState resultState = new ResultState();

  @Override
  public void stop(Stopwatch stopwatch) {
    stopwatch.setState(this.resultState); // æ¬¡ã«é·ç§»ã™ã‚‹çŠ¶æ…‹ã‚’è¨­å®š
    stopwatch.setTime(System.currentTimeMillis() - stopwatch.getStartTime());
  }
}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã§ã—ãŸã€‚
Stateå…·è±¡ã‚¯ãƒ©ã‚¹å†…ã§æ¬¡ã®çŠ¶æ…‹é·ç§»å…ˆã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä¿æŒã—ã¦ã„ã¾ã™ãŒã€

```java
public class InitState implements State {
  private final MeasuringState measuringState = new MeasuringState();
}

public class MeasuringState implements State {
  private final ResultState resultState = new ResultState();
}
```

Stopwatchã«çŠ¶æ…‹ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä¿æŒã—ã¦ã„ã¦ã€ãã®çŠ¶æ…‹ã«é·ç§»ã™ã‚‹æ–¹ãŒè‡ªç„¶ãªæ„Ÿã˜ãŒã—ã¾ã™ã€‚çŠ¶æ…‹è‡ªä½“ã¯Stopwatchå†…éƒ¨ã«ã‚ã‚‹ã¯ãšã§ã™ã€‚
ã¾ãŸã€InitState -> MeasuringState, ResultState -> MeasuringStateã¨ã€MeasuringStateã¸ã®é·ç§»ãŒ2å›ã‚ã‚Šã¾ã™ã€‚ã¾ã å¾Œè€…ã®å®Ÿè£…ãŒãªã„ã®ã§è¡¨é¢åŒ–ã—ã¦ã„ãªã„ã§ã™ãŒã€å°†æ¥çš„ã«`private final MeasuringState measuringState = new MeasuringState();`ãŒé‡è¤‡ã—ãã†ã§ã™ã€‚
Stopwatchã«çŠ¶æ…‹ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç§»å‹•ã•ã›ã¾ã™ã€‚

```java
public class Stopwatch {

  private final MeasuringState measuringState = new MeasuringState();
  private final ResultState resultState = new ResultState();

  MeasuringState getMeasuringState() {
    return this.measuringState;
  }

  ResultState getResultState() {
    return this.resultState;
  }
// ------------------------------------------
public class InitState implements State {
  @Override
  public void start(Stopwatch stopwatch) {
    stopwatch.setState(stopwatch.getMeasuringState());
    stopwatch.setStartTime(System.currentTimeMillis());
  }
}
// ------------------------------------------
public class MeasuringState implements State {
  @Override
  public void stop(Stopwatch stopwatch) {
    stopwatch.setState(stopwatch.getResultState());
    stopwatch.setTime(System.currentTimeMillis() - stopwatch.getStartTime());
  }
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã§ã™ã€‚

ãã†ã„ãˆã°ã€ã“ã‚Œã¾ã§`stopwatch.reset()`ã®æœŸå¾…å‹•ä½œãŒå…¨ã¦ä½•ã‚‚ã—ãªã„ã“ã¨ã ã£ãŸã®ã§å…·ä½“çš„ãªå®Ÿè£…ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€ã“ã‚Œã‚‚çŠ¶æ…‹ã«ã‚ˆã‚ŠæŒ¯ã‚‹èˆã„ãŒå¤‰ã‚ã‚‹ç®‡æ‰€ãªã®ã§Stateã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã«å‡¦ç†ã‚’å§”è­²ã—ã¾ã™ã€‚

```java
interface State {
  public void reset(Stopwatch stopwatch);
}
// ------------------------------------------
public class Stopwatch {
    public void reset() {
    this.state.reset(this);
  }
}
// ------------------------------------------
public class InitState implements State {
  @Override
  public void reset(Stopwatch stopwatch) {
    // do nothing.
  }
}
// ------------------------------------------
public class MeasuringState implements State {
  @Override
  public void reset(Stopwatch stopwatch) {
    // do nothing.
  }
}
// ------------------------------------------
public class ResultState implements State {
  @Override
  public void reset(Stopwatch stopwatch) {
    // TODO è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸãƒ¡ã‚½ãƒƒãƒ‰ãƒ»ã‚¹ã‚¿ãƒ–
  }
}
```
ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã§ã™ã€‚
ã“ã“ã¾ã§ã§æ¦‚ã­Stateãƒ‘ã‚¿ãƒ¼ãƒ³ã¸ã®å¤‰æ›´ã¯å®Œäº†ã§ã™ã€‚
æœ€å¾Œã«`getState()`ã§è¿”ã—ã¦ã„ã‚‹å‹ãŒStringãªã®ãŒã¡ã‚‡ã£ã¨å«Œãªã®ã§enumã«å¤‰æ›´ã—ã¾ã™ã€‚å®šæ•°ã«ã¯enumã‚’ä½¿ã„ãŸã„æ°—æŒã¡ã§ã™ã€‚

```java
interface State {
  public String getState();
}
```

ã¾ãšãƒ†ã‚¹ãƒˆã‚’ä¿®æ­£ã—ã¾ã™ã€‚ ã“ã‚“ãªæ„Ÿã˜ã§æ›¸ã„ã¦ãŸã®ã‚’

```java
assertEquals("MEASURING", stopwatch.getState());
```

ä¸‹è¨˜ã«ä¿®æ­£ã—ã¾ã™ã€‚

```java
assertEquals(StopwatchState.MEASURING, stopwatch.getState());
```

ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã®ã§enumã‚’ä½œã‚Šã¾ã™ã€‚

```java
public enum StopwatchState {
  INIT, MEASURING, RESULT;
}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ãƒ¬ãƒƒãƒ‰ãƒãƒ¼ã§ã™ã€‚
ã§ã¯`getState()`ã§ä»Šä½œã£ãŸenumã‚’è¿”å´ã™ã‚‹ã‚ˆã†ã«ä¿®æ­£ã—ã¾ã™ã€‚

```java
interface State {
  public StopwatchState getState();
}
// ------------------------------------------
public class InitState implements State {
  @Override
  public StopwatchState getState() {
    return StopwatchState.INIT;
  }
}
// ------------------------------------------
public class MeasuringState implements State {
  @Override
  public StopwatchState getState() {
    return StopwatchState.MEASURING;
  }
}
// ------------------------------------------
public class ResultState implements State {
  @Override
  public StopwatchState getState() {
    return StopwatchState.RESULT;
  }
}
// ------------------------------------------
public class Stopwatch {
  public StopwatchState getState() {
    return this.state.getState();
  }
}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã§ã™ã€‚
ã“ã‚Œã§Stateãƒ‘ã‚¿ãƒ¼ãƒ³ã®é©ç”¨ã¯å®Œäº†ã§ã™ã€‚TODOãƒªã‚¹ãƒˆã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¾ã™ã€‚æŒ¯ã‚‹èˆã„ã®åˆ¶å¾¡ã‚’å¤‰ãˆã¦ã€stateã®å‹ã‚’å¤‰ãˆã¾ã—ãŸã€‚
æ¬¡ã¯ã€Œçµæœè¡¨ç¤ºä¸­ã®è¨ˆæ¸¬å€¤ã¯å¤‰åŒ–ã—ãªã„ã€ã«å–ã‚Šçµ„ã¿ã¾ã™ãŒã€ä¸€æ—¦ä»Šå›ã®æŒ¯ã‚Šè¿”ã‚Šã‚’æŒŸã¿ã¾ã™ã€‚

- [x]  ~~åˆæœŸçŠ¶æ…‹ãŒåœæ­¢ä¸­ã€è¨ˆæ¸¬å€¤ãŒ0~~
- [x]  ~~åœæ­¢ä¸­ã§STOPãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„~~
- [x]  ~~åœæ­¢ä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒè¨ˆæ¸¬ä¸­ã«é·ç§»ã™ã‚‹~~
- [x]  ~~è¨ˆæ¸¬ä¸­ã§STARTãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„~~
- [x]  ~~è¨ˆæ¸¬ä¸­ã§STOPãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒçµæœè¡¨ç¤ºä¸­ã«é·ç§»ã™ã‚‹~~
- [ ]  çµæœè¡¨ç¤ºä¸­ã®è¨ˆæ¸¬å€¤ã¯å¤‰åŒ–ã—ãªã„
- [ ]  ...(ç•¥)...
- [x]  ~~stateã¯Stringã§å•é¡Œãªã„ã ã‚ã†ã‹ï¼Ÿ~~
- [x]  ~~çŠ¶æ…‹ã«ã‚ˆã‚‹æŒ¯ã‚‹èˆã„ã®åˆ¶å¾¡ã®ä»•æ–¹ã‚’è€ƒãˆã‚‹~~

### æŒ¯ã‚Šè¿”ã‚Š

æœ€åˆã«ã‚ã’ãŸå•é¡Œç‚¹ãŒè§£æ±ºã§ããŸã‹ç¢ºèªã—ã¦ã¿ã¾ã™ã€‚
stateã«ã‚ˆã‚‹çŠ¶æ…‹åˆ†å²ãŒã‚ã£ãŸå®Ÿè£…ã‚’ç¢ºèªã—ã¾ã™ã€‚

```java
public class Stopwatch {

  private State state;

  void setState(State state) {
    this.state = state;
  }

  public Stopwatch() {
    this.state = new InitState();
    this.startTime = 0l;
    this.time = 0l;
  }

  public long getTime() {
    return this.state.getTime(this);
  }

  public StopwatchState getState() {
    return this.state.getState();
  }

  public void stop() {
    this.state.stop(this);
  }

  public void start() {
    this.state.start(this);
  }

  public void reset() {
    this.state.reset(this);
  }
}
```

- çŠ¶æ…‹ã«ã‚ˆã‚‹åˆ†å²ãŒæ•£ã‚‰ã°ã£ã¦ã„ã‚‹ãŸã‚ã€å¤‰æ›´ã‚’å…¥ã‚Œã‚‹å ´åˆã‚ã¡ã“ã¡ã«æ‰‹ã‚’å…¥ã‚Œã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚é‡è¦ãªå¤‰æ›´ã‚’å®Ÿè£…ã—å¿˜ã‚Œã‚‹å¯èƒ½æ€§ãŒå‡ºã¦ãã‚‹ã€‚å®Ÿéš›ã€[å…ˆã»ã©](#ã‚°ãƒªãƒ¼ãƒ³-5)å®Ÿè£…ã—å¿˜ã‚Œã«ã‚ˆã‚Šæƒ³å®šå¤–ã®ãƒ¬ãƒƒãƒ‰ãƒãƒ¼ãŒå‡ºãŸã€‚
- ãã®çŠ¶æ…‹ã«ä¾ã‚‹å®Ÿè£…ãŒã©ã“ã«ã‚ã‚‹ã‹ã¡ã‚‡ã£ã¨ã‚ã‹ã‚Šã¥ã‚‰ã„ã€‚ifã®æ¡ä»¶ã‚’ç¢ºèªã—ãªã„ã¨ã©ã“ã«ä¿®æ­£ã‚’ã„ã‚Œã‚‹ã¹ãã‹ã‚ã‹ã‚‰ãªã„ã€‚

å¤§åˆ†ã‚¹ãƒƒã‚­ãƒªã—ã¾ã—ãŸã­ã€‚çŠ¶æ…‹ä¾å­˜ã®å®Ÿè£…ã‚’Stateã®å…·è±¡ã‚¯ãƒ©ã‚¹ã«ã¾ã¨ã‚ã‚‰ã‚ŒãŸã®ã§ã€å•é¡Œã‚’è§£æ±ºã§ãã¦ã„ã¾ã™ã€‚

## çµæœè¡¨ç¤ºä¸­ã®è¨ˆæ¸¬å€¤ã¯å¤‰åŒ–ã—ãªã„

### ã‚°ãƒªãƒ¼ãƒ³

æœŸå¾…å‹•ä½œãŒãªã«ã‚‚ãŠã“ã‚‰ãªã„ã“ã¨ã§ã€ç‰¹ã«å®Ÿè£…ã™ã‚‹ã“ã¨ãŒãªã„ã®ã§ã€ã‚°ãƒªãƒ¼ãƒ³ã‹ã‚‰å§‹ã‚ã¾ã™ã€‚
ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ ã—ã¾ã™ã€‚

```java
  public void testResultState() throws Exception {
    Stopwatch stopwatch = new Stopwatch();
    stopwatch.start();
    stopwatch.stop();
    assertEquals(StopwatchState.RESULT, stopwatch.getState());
    long time = stopwatch.getTime();
    Thread.sleep(10l);
    assertEquals(time, stopwatch.getTime());
  }
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ã‚°ãƒªãƒ¼ãƒ³ã§ã—ãŸã€‚
TODOãƒªã‚¹ãƒˆã«ãƒã‚§ãƒƒã‚¯ã‚’ã„ã‚Œã¦ã€Œçµæœè¡¨ç¤ºä¸­ã§STOPãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„ã€ã«é€²ã¿ã¾ã™ã€‚

- [x]  ~~åˆæœŸçŠ¶æ…‹ãŒåœæ­¢ä¸­ã€è¨ˆæ¸¬å€¤ãŒ0~~
- [x]  ~~åœæ­¢ä¸­ã§STOPãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„~~
- [x]  ~~åœæ­¢ä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒè¨ˆæ¸¬ä¸­ã«é·ç§»ã™ã‚‹~~
- [x]  ~~è¨ˆæ¸¬ä¸­ã§STARTãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„~~
- [x]  ~~è¨ˆæ¸¬ä¸­ã§STOPãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒçµæœè¡¨ç¤ºä¸­ã«é·ç§»ã™ã‚‹~~
- [x]  ~~çµæœè¡¨ç¤ºä¸­ã®è¨ˆæ¸¬å€¤ã¯å¤‰åŒ–ã—ãªã„~~
- [ ]  çµæœè¡¨ç¤ºä¸­ã§STOPãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„
- [ ]  ...(ç•¥)...
- [x]  ~~stateã¯Stringã§å•é¡Œãªã„ã ã‚ã†ã‹ï¼Ÿ~~
- [x]  ~~çŠ¶æ…‹ã«ã‚ˆã‚‹æŒ¯ã‚‹èˆã„ã®åˆ¶å¾¡ã®ä»•æ–¹ã‚’è€ƒãˆã‚‹~~

## çµæœè¡¨ç¤ºä¸­ã§STOPãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„

### ã‚°ãƒªãƒ¼ãƒ³

ã¾ãŸã—ã¦ã‚‚ç‰¹ã«å®Ÿè£…ã™ã‚‹ã“ã¨ã¯ãªã„ã®ã§ã‚°ãƒªãƒ¼ãƒ³ã‹ã‚‰å§‹ã‚ã¾ã™ã€‚
ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ ã—ã¾ã™ã€‚

```java
  @Test
  public void testResultState() throws Exception {
    Stopwatch stopwatch = new Stopwatch();
    stopwatch.start();
    stopwatch.stop();
    assertEquals(StopwatchState.RESULT, stopwatch.getState());
    long time = stopwatch.getTime();
    Thread.sleep(10l);
    assertEquals(time, stopwatch.getTime());

    // è¿½åŠ 
    stopwatch.stop();
    Thread.sleep(10l);
    assertEquals(time, stopwatch.getTime());
    assertEquals(StopwatchState.RESULT, stopwatch.getState());
  }
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ã‚°ãƒªãƒ¼ãƒ³ã§ã—ãŸã€‚
ã‚³ãƒ¡ãƒ³ãƒˆã§ä½•ã‚‚ã—ãªã„ã£ã¦ã“ã¨ã ã‘æ›¸ã„ãŠãã¾ã™ã€‚

```java
public class ResultState implements State {
  @Override
  public void stop(Stopwatch stopwatch) {
    // do nothing.
  }
}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ ã—ãŸã ã‘ãªã®ã§ã‚‚ã¡ã‚ã‚“ã‚°ãƒªãƒ¼ãƒ³ã®ã¾ã¾ã§ã—ãŸã€‚
ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹å†…å®¹ãŒãªã„ã®ã§ã€TODOãƒªã‚¹ãƒˆã«ãƒã‚§ãƒƒã‚¯ã‚’ã„ã‚Œã¦ã€Œçµæœè¡¨ç¤ºä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§è¨ˆæ¸¬ä¸­ã«é·ç§»ã™ã‚‹ã€ã«é€²ã¿ã¾ã™ã€‚

- [x]  ~~åˆæœŸçŠ¶æ…‹ãŒåœæ­¢ä¸­ã€è¨ˆæ¸¬å€¤ãŒ0~~
- [x]  ~~åœæ­¢ä¸­ã§STOPãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„~~
- [x]  ~~åœæ­¢ä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒè¨ˆæ¸¬ä¸­ã«é·ç§»ã™ã‚‹~~
- [x]  ~~è¨ˆæ¸¬ä¸­ã§STARTãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„~~
- [x]  ~~è¨ˆæ¸¬ä¸­ã§STOPãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒçµæœè¡¨ç¤ºä¸­ã«é·ç§»ã™ã‚‹~~
- [x]  ~~çµæœè¡¨ç¤ºä¸­ã®è¨ˆæ¸¬å€¤ã¯å¤‰åŒ–ã—ãªã„~~
- [x]  ~~çµæœè¡¨ç¤ºä¸­ã§STOPãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„~~
- [ ]  çµæœè¡¨ç¤ºä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§è¨ˆæ¸¬ä¸­ã«é·ç§»ã™ã‚‹
- [ ]  çµæœè¡¨ç¤ºä¸­ã§RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§åœæ­¢ä¸­ã«é·ç§»ã™ã‚‹
- [x]  ~~time, stateã‚’privateã«ã™ã‚‹~~
- [x]  ~~stateã¯Stringã§å•é¡Œãªã„ã ã‚ã†ã‹ï¼Ÿ~~
- [x]  ~~çŠ¶æ…‹ã«ã‚ˆã‚‹æŒ¯ã‚‹èˆã„ã®åˆ¶å¾¡ã®ä»•æ–¹ã‚’è€ƒãˆã‚‹~~

## çµæœè¡¨ç¤ºä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§è¨ˆæ¸¬ä¸­ã«é·ç§»ã™ã‚‹

### ãƒ¬ãƒƒãƒ‰

ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ ã—ã¾ã™ã€‚

```java
  @Test
  public void testResultState() throws Exception {
    Stopwatch stopwatch = new Stopwatch();
    stopwatch.start();
    stopwatch.stop();
    assertEquals(StopwatchState.RESULT, stopwatch.getState());
    long time = stopwatch.getTime();
    Thread.sleep(10l);
    assertEquals(time, stopwatch.getTime());

    stopwatch.stop();
    Thread.sleep(10l);
    assertEquals(time, stopwatch.getTime());
    assertEquals(StopwatchState.RESULT, stopwatch.getState());

    // è¿½åŠ 
    stopwatch.start();
    assertEquals(StopwatchState.MEASURING, stopwatch.getState());
  }
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ãƒ¬ãƒƒãƒ‰ãƒãƒ¼ã§ã—ãŸã€‚
ãƒ†ã‚¹ãƒˆã‚’è€ƒãˆã¦æ°—ã¥ã„ãŸã®ã§ã™ãŒã€è¨ˆæ¸¬ä¸­ã«é·ç§»ã™ã‚‹éš›ã«çŠ¶æ…‹ã‚’å¤‰ãˆã‚‹ã®ã«åŠ ãˆã¦ã€è¨ˆæ¸¬æ™‚é–“ã«ã„ã¾ã¾ã§è¨˜éŒ²ã—ãŸæ™‚é–“ã‚’è¶³ã›ã‚‹ã‚ˆã†ã«ã—ãªã„ã¨ã ã‚ã§ã™ã­ã€‚
TODOãƒªã‚¹ãƒˆã«åŠ ãˆã¾ã™ã€‚

- [x]  ~~åˆæœŸçŠ¶æ…‹ãŒåœæ­¢ä¸­ã€è¨ˆæ¸¬å€¤ãŒ0~~
- [x]  ~~åœæ­¢ä¸­ã§STOPãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„~~
- [x]  ~~åœæ­¢ä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒè¨ˆæ¸¬ä¸­ã«é·ç§»ã™ã‚‹~~
- [x]  ~~è¨ˆæ¸¬ä¸­ã§STARTãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„~~
- [x]  ~~è¨ˆæ¸¬ä¸­ã§STOPãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒçµæœè¡¨ç¤ºä¸­ã«é·ç§»ã™ã‚‹~~
- [x]  ~~çµæœè¡¨ç¤ºä¸­ã®è¨ˆæ¸¬å€¤ã¯å¤‰åŒ–ã—ãªã„~~
- [x]  ~~çµæœè¡¨ç¤ºä¸­ã§STOPãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„~~
- [ ]  çµæœè¡¨ç¤ºä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§è¨ˆæ¸¬ä¸­ã«é·ç§»ã™ã‚‹
- [ ]  çµæœè¡¨ç¤ºä¸­ -> è¨ˆæ¸¬ä¸­ã§ã€è¨ˆæ¸¬æ™‚é–“ã«è¨˜éŒ²æ¸ˆã¿ã®æ™‚é–“ã‚’è¶³ã›ã‚‹ã‚ˆã†ã«ã™ã‚‹(NEW)
- [ ]  çµæœè¡¨ç¤ºä¸­ã§RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§åœæ­¢ä¸­ã«é·ç§»ã™ã‚‹
- [x]  ~~time, stateã‚’privateã«ã™ã‚‹~~
- [x]  ~~stateã¯Stringã§å•é¡Œãªã„ã ã‚ã†ã‹ï¼Ÿ~~
- [x]  ~~çŠ¶æ…‹ã«ã‚ˆã‚‹æŒ¯ã‚‹èˆã„ã®åˆ¶å¾¡ã®ä»•æ–¹ã‚’è€ƒãˆã‚‹~~

### ã‚°ãƒªãƒ¼ãƒ³

å®Ÿè£…ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```java
public class ResultState implements State {

  @Override
  public void start(Stopwatch stopwatch) {
    stopwatch.setState(stopwatch.getMeasuringState());
  }
}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã§ã™ã€‚

ã“ã“ã‚‚ç‰¹ã«ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹ã“ã¨ãªã„ã®ã§ã€Œçµæœè¡¨ç¤ºä¸­ -> è¨ˆæ¸¬ä¸­ã§ã€è¨ˆæ¸¬æ™‚é–“ã«è¨˜éŒ²æ¸ˆã¿ã®æ™‚é–“ã‚’è¶³ã›ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€ã«é€²ã¿ã¾ã™ã€‚TODOãƒªã‚¹ãƒˆã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¾ã™ã€‚

- [x]  ~~åˆæœŸçŠ¶æ…‹ãŒåœæ­¢ä¸­ã€è¨ˆæ¸¬å€¤ãŒ0~~
- [x]  ~~åœæ­¢ä¸­ã§STOPãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„~~
- [x]  ~~åœæ­¢ä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒè¨ˆæ¸¬ä¸­ã«é·ç§»ã™ã‚‹~~
- [x]  ~~è¨ˆæ¸¬ä¸­ã§STARTãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„~~
- [x]  ~~è¨ˆæ¸¬ä¸­ã§STOPãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒçµæœè¡¨ç¤ºä¸­ã«é·ç§»ã™ã‚‹~~
- [x]  ~~çµæœè¡¨ç¤ºä¸­ã®è¨ˆæ¸¬å€¤ã¯å¤‰åŒ–ã—ãªã„~~
- [x]  ~~çµæœè¡¨ç¤ºä¸­ã§STOPãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„~~
- [x]  ~~çµæœè¡¨ç¤ºä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§è¨ˆæ¸¬ä¸­ã«é·ç§»ã™ã‚‹~~
- [ ]  çµæœè¡¨ç¤ºä¸­ -> è¨ˆæ¸¬ä¸­ã§ã€è¨ˆæ¸¬æ™‚é–“ã«è¨˜éŒ²æ¸ˆã¿ã®æ™‚é–“ã‚’è¶³ã›ã‚‹ã‚ˆã†ã«ã™ã‚‹
- [ ]  çµæœè¡¨ç¤ºä¸­ã§RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§åœæ­¢ä¸­ã«é·ç§»ã™ã‚‹
- [x]  ~~time, stateã‚’privateã«ã™ã‚‹~~
- [x]  ~~stateã¯Stringã§å•é¡Œãªã„ã ã‚ã†ã‹ï¼Ÿ~~
- [x]  ~~çŠ¶æ…‹ã«ã‚ˆã‚‹æŒ¯ã‚‹èˆã„ã®åˆ¶å¾¡ã®ä»•æ–¹ã‚’è€ƒãˆã‚‹~~

## çµæœè¡¨ç¤ºä¸­ -> è¨ˆæ¸¬ä¸­ã§ã€è¨ˆæ¸¬æ™‚é–“ã«è¨˜éŒ²æ¸ˆã¿ã®æ™‚é–“ã‚’è¶³ã›ã‚‹ã‚ˆã†ã«ã™ã‚‹

### ãƒ¬ãƒƒãƒ‰

ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ ã—ã¾ã™ã€‚

```java
  @Test
  public void testResultThenStart() throws Exception {
    Stopwatch stopwatch = new Stopwatch();
    stopwatch.start();
    Thread.sleep(10l);
    stopwatch.stop();
    stopwatch.start();
    Thread.sleep(10l);
    long time = stopwatch.getTime();
    stopwatch.stop();
    assertTrue(20l <= time && time <= 25l);
  }
```

è¨ˆæ¸¬ä¸­ -> 10ms -> çµæœè¡¨ç¤ºä¸­ -> è¨ˆæ¸¬ä¸­ -> 10ms -> è¨ˆæ¸¬æ™‚é–“å–å¾— -> çµæœè¡¨ç¤ºä¸­ ã¨é·ç§»ã—ã¦ã„ã‚‹ã®ã§ã ã„ãŸã„20msã®ã¯ãšã§ã™ã€‚æ™‚é–“ã®è¨ˆç®—ç­‰ãŒã‚ã‚‹ã®ã§20msã´ã£ãŸã‚Šã«åã‚ã‚‹ã“ã¨ãŒé›£ã—ãã†ãªã®ã§ã€20ms <= time <= 25 ãªã‚‰ã‚ˆã—ã¨ã—ã¾ã™ã€‚è¨˜éŒ²æ¸ˆã¿ã®è¨ˆæ¸¬æ™‚é–“ãŒè¶³ã•ã‚Œã¦ã„ã‚‹ã®ã‚’ç¢ºèªã™ã‚‹ã®ãŒè¶£æ—¨ãªã®ã§ã€ã“ã‚Œã§ã‚‚ã„ã„ã§ã—ã‚‡ã†ã€‚ï¼ˆã„ã„ã¨ã„ã†ã“ã¨ã«ã—ãŸã„ï¼‰

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ãƒ¬ãƒƒãƒ‰ãƒãƒ¼ã§ã—ãŸã€‚

### ã‚°ãƒªãƒ¼ãƒ³

ã“ã“ã®å®Ÿè£…ã‚’å¤‰ãˆã‚Œã°ã©ã†ã«ã‹ãªã‚Šãã†ã§ã™ã€‚

```java
public class MeasuringState implements State {

  @Override
  public void stop(Stopwatch stopwatch) {
    stopwatch.setState(stopwatch.getResultState());
    stopwatch.setTime(System.currentTimeMillis() - stopwatch.getStartTime());
  }

  @Override
  public long getTime(Stopwatch stopwatch) {
    return System.currentTimeMillis() - stopwatch.getStartTime();
  }

}
// ------------------------------------------
public class ResultState implements State {
  @Override
  public void start(Stopwatch stopwatch) {
    stopwatch.setState(stopwatch.getMeasuringState());
  }
}
```

ç¾åœ¨ã®æ™‚é–“ - STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã®æ™‚é–“ã¨è¨ˆç®—ã—ã¦ã„ã‚‹ã®ã‚’
ç¾åœ¨ã®æ™‚é–“ - STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã®æ™‚é–“ + ä»Šã¾ã§ã®è¨ˆæ¸¬æ™‚é–“ ã¨å¤‰æ›´ã™ã‚‹ã“ã¨ã§ã†ã¾ã„ã“ã¨è¨ˆç®—ã§ããã†ã§ã™ã€‚
è¨ˆç®—ã™ã‚‹ãŸã‚ã«ã¯ã€çµæœè¡¨ç¤ºä¸­ -> è¨ˆæ¸¬ä¸­é·ç§»æ™‚ã«STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã®æ™‚é–“ã‚’æ›´æ–°ã™ã‚‹å®Ÿè£…ã‚’è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã§ã“ã‚Œã‚‚è¿½åŠ ã—ã¾ã™ã€‚

```java
public class MeasuringState implements State {

  @Override
  public void stop(Stopwatch stopwatch) {
    stopwatch.setState(stopwatch.getResultState());
    //                  ã€€ã€€ã€€ ç¾åœ¨ã®æ™‚é–“ã€€ã€€ã€€ã€€ã€€ã€€ -   STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã®æ™‚é–“   +  ä»Šã¾ã§ã®è¨ˆæ¸¬æ™‚é–“
    stopwatch.setTime(System.currentTimeMillis() - stopwatch.getStartTime() + stopwatch.getTimeInner());
  }

  @Override
  public long getTime(Stopwatch stopwatch) {
    return System.currentTimeMillis() - stopwatch.getStartTime() + stopwatch.getTimeInner();
  }
}
// ------------------------------------------
public class ResultState implements State {
  @Override
  public void start(Stopwatch stopwatch) {
    stopwatch.setState(stopwatch.getMeasuringState());
    // è¿½åŠ  STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã®æ™‚é–“ã‚’æ›´æ–°
    stopwatch.setStartTime(System.currentTimeMillis()); 
  }
}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã§ã™ã€‚

### ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°

`System.currentTimeMillis() - stopwatch.getStartTime() + stopwatch.getTimeInner()`ã“ã®è¨ˆç®—ã‚’ï¼’ç®‡æ‰€ã§è¡Œã£ã¦ã„ã¦ã€å®Ÿè£…ãŒé‡è¤‡ã—ã¦ã„ã‚‹ã“ã¨ã«æ°—ã¥ã„ãŸã®ã§ãƒ¡ã‚½ãƒƒãƒ‰ã«æŠ½å‡ºã—ã¾ã™ã€‚

```java
public class MeasuringState implements State {

  @Override
  public void stop(Stopwatch stopwatch) {
    stopwatch.setState(stopwatch.getResultState());
    stopwatch.setTime(calculateTime(stopwatch));
  }

  private long calculateTime(Stopwatch stopwatch) {
    return System.currentTimeMillis() - stopwatch.getStartTime() + stopwatch.getTimeInner();
  }

  @Override
  public long getTime(Stopwatch stopwatch) {
    return calculateTime(stopwatch);
  }
}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã§ã™ã€‚
TODOãƒªã‚¹ãƒˆã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¦ã€Œçµæœè¡¨ç¤ºä¸­ã§RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§åœæ­¢ä¸­ã«é·ç§»ã™ã‚‹ã€ã¸é€²ã¿ã¾ã™ã€‚

- [x]  ~~åˆæœŸçŠ¶æ…‹ãŒåœæ­¢ä¸­ã€è¨ˆæ¸¬å€¤ãŒ0~~
- [x]  ~~åœæ­¢ä¸­ã§STOPãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„~~
- [x]  ~~åœæ­¢ä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒè¨ˆæ¸¬ä¸­ã«é·ç§»ã™ã‚‹~~
- [x]  ~~è¨ˆæ¸¬ä¸­ã§STARTãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„~~
- [x]  ~~è¨ˆæ¸¬ä¸­ã§STOPãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒçµæœè¡¨ç¤ºä¸­ã«é·ç§»ã™ã‚‹~~
- [x]  ~~çµæœè¡¨ç¤ºä¸­ã®è¨ˆæ¸¬å€¤ã¯å¤‰åŒ–ã—ãªã„~~
- [x]  ~~çµæœè¡¨ç¤ºä¸­ã§STOPãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„~~
- [x]  ~~çµæœè¡¨ç¤ºä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§è¨ˆæ¸¬ä¸­ã«é·ç§»ã™ã‚‹~~
- [x]  ~~çµæœè¡¨ç¤ºä¸­ -> è¨ˆæ¸¬ä¸­ã§ã€è¨ˆæ¸¬æ™‚é–“ã«è¨˜éŒ²æ¸ˆã¿ã®æ™‚é–“ã‚’è¶³ã›ã‚‹ã‚ˆã†ã«ã™ã‚‹~~
- [ ]  çµæœè¡¨ç¤ºä¸­ã§RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§åœæ­¢ä¸­ã«é·ç§»ã™ã‚‹
- [x]  ~~time, stateã‚’privateã«ã™ã‚‹~~
- [x]  ~~stateã¯Stringã§å•é¡Œãªã„ã ã‚ã†ã‹ï¼Ÿ~~
- [x]  ~~çŠ¶æ…‹ã«ã‚ˆã‚‹æŒ¯ã‚‹èˆã„ã®åˆ¶å¾¡ã®ä»•æ–¹ã‚’è€ƒãˆã‚‹~~

## çµæœè¡¨ç¤ºä¸­ã§RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§åœæ­¢ä¸­ã«é·ç§»ã™ã‚‹

### ãƒ¬ãƒƒãƒ‰

ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ ã—ã¾ã™ã€‚

```java
  @Test
  public void testResultThenReset() throws Exception {
    Stopwatch stopwatch = new Stopwatch();
    stopwatch.start();
    Thread.sleep(10l);
    stopwatch.stop();
    stopwatch.reset();
    Thread.sleep(10l);
    assertEquals(0l, stopwatch.getTime());
    assertEquals(StopwatchState.INIT, stopwatch.getState());
  }
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ãƒ¬ãƒƒãƒ‰ãƒãƒ¼ã§ã™ã€‚

### ã‚°ãƒªãƒ¼ãƒ³

çŠ¶æ…‹ã‚’å¤‰æ›´ã™ã‚‹å®Ÿè£…ã¨ã€è¨ˆæ¸¬å€¤ã‚’0ã«ã™ã‚‹å®Ÿè£…ã‚’å…¥ã‚Œã¾ã™ã€‚

```java
public class Stopwatch {

  private final InitState initState = new InitState();

  InitState getInitState() {
    return this.initState;
  }
}
// ------------------------------------------
public class ResultState implements State {

  @Override
  public void reset(Stopwatch stopwatch) {
    stopwatch.setState(stopwatch.getInitState());
    stopwatch.setTime(0l);
  }

}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã§ã™ã€‚

### ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°

ã“ã®å®Ÿè£…ãŒç›®ã«å…¥ã£ãŸã®ã§

```java
public class Stopwatch {

  public Stopwatch() {
    this.state = new InitState();
    this.startTime = 0l;
    this.time = 0l;
  }

}
```

ä¿®æ­£ã—ã¾ã™ã€‚å…ˆã»ã©è¿½åŠ ã—ãŸinitStateã‚’ä½¿ã£ã¦stateã®åˆæœŸåŒ–ã‚’ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

```java
public class Stopwatch {

  private final InitState initState = new InitState();

  InitState getInitState() {
    return this.initState;
  }

  public Stopwatch() {
    this.state = this.getInitState();
    this.startTime = 0l;
    this.time = 0l;
  }
}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã€‚ã€‚ã‚°ãƒªãƒ¼ãƒ³ãƒãƒ¼ã§ã™ã€‚
TODOãƒªã‚¹ãƒˆã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¾ã™ã€‚

- [x]  ~~åˆæœŸçŠ¶æ…‹ãŒåœæ­¢ä¸­ã€è¨ˆæ¸¬å€¤ãŒ0~~
- [x]  ~~åœæ­¢ä¸­ã§STOPãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„~~
- [x]  ~~åœæ­¢ä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒè¨ˆæ¸¬ä¸­ã«é·ç§»ã™ã‚‹~~
- [x]  ~~è¨ˆæ¸¬ä¸­ã§STARTãƒœã‚¿ãƒ³ã€RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„~~
- [x]  ~~è¨ˆæ¸¬ä¸­ã§STOPãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§çŠ¶æ…‹ãŒçµæœè¡¨ç¤ºä¸­ã«é·ç§»ã™ã‚‹~~
- [x]  ~~çµæœè¡¨ç¤ºä¸­ã®è¨ˆæ¸¬å€¤ã¯å¤‰åŒ–ã—ãªã„~~
- [x]  ~~çµæœè¡¨ç¤ºä¸­ã§STOPãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§ä½•ã‚‚ãŠããªã„~~
- [x]  ~~çµæœè¡¨ç¤ºä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§è¨ˆæ¸¬ä¸­ã«é·ç§»ã™ã‚‹~~
- [x]  ~~çµæœè¡¨ç¤ºä¸­ -> è¨ˆæ¸¬ä¸­ã§ã€è¨ˆæ¸¬æ™‚é–“ã«è¨˜éŒ²æ¸ˆã¿ã®æ™‚é–“ã‚’è¶³ã›ã‚‹ã‚ˆã†ã«ã™ã‚‹~~
- [x]  ~~çµæœè¡¨ç¤ºä¸­ã§RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹ã§åœæ­¢ä¸­ã«é·ç§»ã™ã‚‹~~
- [x]  ~~time, stateã‚’privateã«ã™ã‚‹~~
- [x]  ~~stateã¯Stringã§å•é¡Œãªã„ã ã‚ã†ã‹ï¼Ÿ~~
- [x]  ~~çŠ¶æ…‹ã«ã‚ˆã‚‹æŒ¯ã‚‹èˆã„ã®åˆ¶å¾¡ã®ä»•æ–¹ã‚’è€ƒãˆã‚‹~~

ã“ã‚Œã§å…¨ã¦ã®TODOã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸï¼ï¼

ã“ã“ã¾ã§ã®ã‚³ãƒ¼ãƒ‰å…¨éƒ¨è¼‰ã›ã—ã¦ãŠãã¾ã™ã€‚

```java
public class Stopwatch {

  private State state;
  private long startTime;
  private long time;
  private final MeasuringState measuringState = new MeasuringState();
  private final ResultState resultState = new ResultState();
  private final InitState initState = new InitState();

  MeasuringState getMeasuringState() {
    return this.measuringState;
  }

  ResultState getResultState() {
    return this.resultState;
  }

  InitState getInitState() {
    return this.initState;
  }

  void setState(State state) {
    this.state = state;
  }

  void setStartTime(long startTime) {
    this.startTime = startTime;
  }

  long getStartTime() {
    return this.startTime;
  }

  void setTime(long time) {
    this.time = time;
  }

  public Stopwatch() {
    this.state = this.getInitState();
    this.startTime = 0l;
    this.time = 0l;
  }

  long getTimeInner() {
    return this.time;
  }

  public long getTime() {
    return this.state.getTime(this);
  }

  public StopwatchState getState() {
    return this.state.getState();
  }

  public void stop() {
    this.state.stop(this);
  }

  public void reset() {
    this.state.reset(this);
  }

  public void start() {
    this.state.start(this);
  }
}
```

```java
interface State {

  public void start(Stopwatch stopwatch);

  public void stop(Stopwatch stopwatch);

  public long getTime(Stopwatch stopwatch);

  public void reset(Stopwatch stopwatch);

  public StopwatchState getState();

}
```

```java
public class InitState implements State {

  @Override
  public void start(Stopwatch stopwatch) {
    stopwatch.setState(stopwatch.getMeasuringState());
    stopwatch.setStartTime(System.currentTimeMillis());
  }

  @Override
  public void stop(Stopwatch stopwatch) {
    // do nothing.
  }

  @Override
  public long getTime(Stopwatch stopwatch) {
    return 0l;
  }

  @Override
  public StopwatchState getState() {
    return StopwatchState.INIT;
  }

  @Override
  public void reset(Stopwatch stopwatch) {
    // do nothing.
  }

}
```

```java
public class MeasuringState implements State {

  @Override
  public void start(Stopwatch stopwatch) {
    // do nothing.
  }

  @Override
  public void stop(Stopwatch stopwatch) {
    stopwatch.setState(stopwatch.getResultState());
    stopwatch.setTime(calculateTime(stopwatch));
  }

  private long calculateTime(Stopwatch stopwatch) {
    return System.currentTimeMillis() - stopwatch.getStartTime() + stopwatch.getTimeInner();
  }

  @Override
  public long getTime(Stopwatch stopwatch) {
    return calculateTime(stopwatch);
  }

  @Override
  public StopwatchState getState() {
    return StopwatchState.MEASURING;
  }

  @Override
  public void reset(Stopwatch stopwatch) {
    // do nothing.
  }

}
```

```java
public class ResultState implements State {

  @Override
  public void start(Stopwatch stopwatch) {
    stopwatch.setState(stopwatch.getMeasuringState());
    stopwatch.setStartTime(System.currentTimeMillis());
  }

  @Override
  public StopwatchState getState() {
    return StopwatchState.RESULT;
  }

  @Override
  public long getTime(Stopwatch stopwatch) {
    return stopwatch.getTimeInner();
  }

  @Override
  public void stop(Stopwatch stopwatch) {
    // do nothing.
  }

  @Override
  public void reset(Stopwatch stopwatch) {
    stopwatch.setState(stopwatch.getInitState());
    stopwatch.setTime(0l);
  }

}
```

```java
import static org.junit.jupiter.api.Assertions.*;

import org.junit.jupiter.api.Test;

public class StopwatchTest {
  @Test
  public void testStopState() {
    Stopwatch stopwatch = new Stopwatch();
    assertEquals(StopwatchState.INIT, stopwatch.getState());
    assertEquals(0l, stopwatch.getTime());
    stopwatch.stop();
    stopwatch.reset();
    assertEquals(StopwatchState.INIT, stopwatch.getState());
    assertEquals(0l, stopwatch.getTime());
  }

  @Test
  public void testMeasuringState() throws Exception {
    Stopwatch stopwatch = new Stopwatch();
    stopwatch.start();
    assertEquals(StopwatchState.MEASURING, stopwatch.getState());

    // è¨ˆæ¸¬ä¸­ã§STARTãƒœã‚¿ãƒ³æŠ¼ä¸‹
    long firstTime = stopwatch.getTime();
    stopwatch.start();
    Thread.sleep(10l);
    long secondTime = stopwatch.getTime();
    assertEquals(true, firstTime < secondTime);
    assertEquals(StopwatchState.MEASURING, stopwatch.getState());

    // è¨ˆæ¸¬ä¸­ã§RESETãƒœã‚¿ãƒ³æŠ¼ä¸‹
    stopwatch.reset();
    Thread.sleep(10l);
    long thirdTime = stopwatch.getTime();
    assertEquals(true, secondTime < thirdTime);
    assertEquals(StopwatchState.MEASURING, stopwatch.getState());

    // è¨ˆæ¸¬ä¸­ã§STOPãƒœã‚¿ãƒ³æŠ¼ä¸‹
    long stoppedTime = stopwatch.getTime();
    stopwatch.stop();
    Thread.sleep(10l);
    assertEquals(StopwatchState.RESULT, stopwatch.getState());
    assertEquals(stoppedTime, stopwatch.getTime());
  }

  @Test
  public void testResultState() throws Exception {
    Stopwatch stopwatch = new Stopwatch();
    stopwatch.start();
    stopwatch.stop();
    assertEquals(StopwatchState.RESULT, stopwatch.getState());
    long time = stopwatch.getTime();
    Thread.sleep(10l);
    assertEquals(time, stopwatch.getTime());

    stopwatch.stop();
    Thread.sleep(10l);
    assertEquals(time, stopwatch.getTime());
    assertEquals(StopwatchState.RESULT, stopwatch.getState());

    stopwatch.start();
    Thread.sleep(10l);
    assertEquals(StopwatchState.MEASURING, stopwatch.getState());
  }

  @Test
  public void testResultThenStart() throws Exception {
    Stopwatch stopwatch = new Stopwatch();
    stopwatch.start();
    Thread.sleep(10l);
    stopwatch.stop();
    stopwatch.start();
    Thread.sleep(10l);
    long time = stopwatch.getTime();
    stopwatch.stop();
    assertTrue(20l <= time && time <= 25l);
  }

  @Test
  public void testResultThenReset() throws Exception {
    Stopwatch stopwatch = new Stopwatch();
    stopwatch.start();
    Thread.sleep(10l);
    stopwatch.stop();
    stopwatch.reset();
    Thread.sleep(10l);
    assertEquals(0l, stopwatch.getTime());
    assertEquals(StopwatchState.INIT, stopwatch.getState());
  }

}
```

# ãŠã‚ã‚Š

é•·ã€…ã¨ãŠä»˜ãåˆã„ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚

TODOãƒªã‚¹ãƒˆã‚’ã‚‚ã£ã¨ç´°ã‹ãä½œã£ãŸæ–¹ãŒTDDé€²ã‚ã‚„ã™ã‹ã£ãŸã‚ã†ãªã¨æ€ã„ã¾ã™ã€‚ä¸€ã¤ã®TODOã§äºŒã¤ä»¥ä¸Šã®ã“ã¨ã‚’ã‚„ã£ã¦ã‚‹ç®‡æ‰€ãŒã‚ã‚Šè‰¯ããªã‹ã£ãŸã§ã™ã€‚ã‚¿ã‚¹ã‚¯ã‚’ã†ã¾ãåˆ†å‰²ã§ãã¦ãªã„ã£ã¦ã“ã¨ã§ã™ã­ã€‚
Stateãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ã£ã¦ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã—ã¦ã¿ãŸã„ã¨ã„ã†æ„å›³ã‚‚ã‚ã‚Šã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å°å…¥ãŒé…ããªã£ãŸã›ã„ã§ã€å¤§å¤‰ãªæ‰‹è¡“ã«ãªã£ã¦ã—ã¾ã„ã¾ã—ãŸã€‚å®Ÿéš›ã¯ã€ã¾ãã“ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ä½¿ãˆã°ã„ã„æ„Ÿã˜ã«ãªã‚‹ã£ã—ã‚‡ã€ã£ã¦ã„ã†å½“ãŸã‚ŠãŒã¤ã„ã¦ã„ã‚‹ãªã‚‰ã•ã£ã•ã¨å°å…¥ã™ã‚‹æ–¹ãŒã„ã„ã§ã—ã‚‡ã†ã€‚ãŸã ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å°å…¥ã¯ãã‚Œãªã‚Šã«ã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚‹ã‚‚ã®ãªã®ã§ã€ãã‚Œã«è¦‹åˆã†ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚‹ã‹è€ƒãˆã¦ã‹ã‚‰å°å…¥ã—ãŸã„ã§ã™ã€‚
ã‚¹ãƒˆãƒƒãƒ—ã‚¦ã‚©ãƒƒãƒã£ã¦ã„ã†é¡Œæã‚‚å¾®å¦™ã§ã—ãŸã­ã€‚æ™‚é–“è¨ˆæ¸¬ã®ãƒ†ã‚¹ãƒˆã‚’ã¡ã‚ƒã‚“ã¨ã‚„ã‚‹æ–¹æ³•ã‚’çŸ¥ã‚‰ãªã„ã—ã€ãã®ãƒ†ã‚¹ãƒˆã§ã„ã„ã®ã‹ç›®ã‚’ã¤ã¶ã‚ŠãªãŒã‚‰é€²ã‚ãŸæ„Ÿã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã«æ°—ã¥ãå‰ã«ã€ã‚³ãƒ¼ãƒ‰ã‚‚è¨˜äº‹ã‚‚ç›¸å½“æ›¸ã„ã¡ã‚ƒã£ã¦ãŸã‚“ã§ç¶šè¡Œã—ã¡ã‚ƒã„ã¾ã—ãŸã€‚

ãƒ¬ãƒƒãƒ‰ -> ã‚°ãƒªãƒ¼ãƒ³ -> ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®æµã‚Œã¯ã€æƒ³åƒä»¥ä¸Šã«ä½œæ¥­ã‚’é€²ã‚ã‚„ã™ãã—ã¦ãã‚Œã‚‹ã¨æ„Ÿã˜ã¾ã—ãŸã€‚æ¬¡èµ·ãã‚‹ã“ã¨ãŒæƒ³å®šé€šã‚Šã§ã‚ã‚‹ã“ã¨ãŒã‹ãªã‚Šå¿ƒç†çš„å®‰å…¨ã‚’æ‹…ä¿ã—ã¦ãã‚Œã¾ã™ã€‚ã¨ã«ã‹ãã‚°ãƒªãƒ¼ãƒ³ã«é€²ã‚“ã§ãã®ã‚°ãƒªãƒ¼ãƒ³ã‚’å´©ã•ãªã„ã‚ˆã†ã«ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã‚’ã™ã‚‹ã“ã¨ã§ã€å®‰å®šã—ãŸçŠ¶æ³ã€æœŸå¾…é€šã‚Šã®æŒ¯ã‚‹èˆã„ãŒã‚ã‚‹çŠ¶æ³ã€ã«é•·ãå±…ã‚‰ã‚Œã‚‹ã®ãŒã„ã„ã§ã™ã­ã€‚

# å‚è€ƒæ–‡çŒ®

- [ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™º](https://shop.ohmsha.co.jp/shopdetail/000000004967/)
- [ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã«ãŠã‘ã‚‹å†åˆ©ç”¨ã®ãŸã‚ã®ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³(æ”¹è¨‚ç‰ˆï¼‰](https://www.sbcr.jp/product/4797311126/)
- [Head Firstãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³â€•â€•é ­ã¨ã‹ã‚‰ã ã§è¦šãˆã‚‹ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã®åŸºæœ¬](https://www.oreilly.co.jp/books/4873112494/)
- [æ–°è£…ç‰ˆ ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚° æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰ã‚’å®‰å…¨ã«æ”¹å–„ã™ã‚‹](https://www.ohmsha.co.jp/book/9784274050190/)
- [Effective Java ç¬¬3ç‰ˆ](https://www.maruzen-publishing.co.jp/item/?book_no=303054)
- [ã€ã“ã®1å†Šã§ã‚ˆãã‚ã‹ã‚‹ã€‘ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãƒ†ã‚¹ãƒˆã®æ•™ç§‘æ›¸ï¼»å¢—è£œæ”¹è¨‚ ç¬¬ï¼’ç‰ˆï¼½](https://www.sbcr.jp/product/4815608750/)